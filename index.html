<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="theme-color" content="#1e5ba8" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="Hakuba Karate" />
        <meta
            name="description"
            content="Hakuba Wado Ryu Karate Learning System - Learn Japanese karate terminology, techniques, and prepare for gradings."
        />
        <title>Hakuba Wado Ryu - Complete Learning System</title>
        <link
            rel="manifest"
            href="data:application/json;base64,ewogICJuYW1lIjogIkhha3ViYSBXYWRvIFJ5dSBLYXJhdGUiLAogICJzaG9ydF9uYW1lIjogIkhha3ViYSBLYXJhdGUiLAogICJkZXNjcmlwdGlvbiI6ICJMZWFybiBKYXBhbmVzZSBrYXJhdGUgdGVybWlub2xvZ3kgYW5kIHRlY2huaXF1ZXMiLAogICJzdGFydF91cmwiOiAiLiIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiI2Y1ZjdmYSIsCiAgInRoZW1lX2NvbG9yIjogIiMxZTViYTgiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSFpwWlhkQ2IzZzlJakFnTUNBeE9USWdNVGt5SWlCM2FXUjBhRDBpTVRreUlpQm9aV2xuYUhROUlqRTVNaUkrUEhKbFkzUWdkMmxrZEdnOUlqRTVNaUlnYUdWcFoyaDBQU0l4T1RJaUlISjRQU0l4TmlJZ1ptbHNiRDBpSXpGbE5XSmhPQ0l2UGp4MFpYaDBJSGc5SWprMklpQjVQU0k1TmlJZ1ptOXVkQzFtWVcxcGJIazlJa0Z5YVdGc0xITmhibk10YzJWeWFXWWlJR1p2Ym5RdGMybDZaVDBpTkRnaUlHWnBiR3c5SW5kb2FYUmxJaUIwWlhoMExXRnVZMmh2Y2owaWJXbGtaR3hsSWo1U2ZEd3ZkR1Y0ZEQ0OEwzTjJaejQ9IiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIgogICAgfQogIF0KfQ=="
        />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@500;600;700;800&display=swap"
            rel="stylesheet"
        />
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            html,
            body {
                min-height: 100vh;
            }

            body {
                font-family:
                    "Inter",
                    -apple-system,
                    BlinkMacSystemFont,
                    "Segoe UI",
                    Roboto,
                    sans-serif;
                background: #f5f7fa;
                color: #1f2937;
                line-height: 1.8;
                font-size: 18px;
                display: flex;
                flex-direction: column;
            }

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                font-family:
                    "Outfit",
                    -apple-system,
                    BlinkMacSystemFont,
                    "Segoe UI",
                    Roboto,
                    sans-serif;
            }

            .container {
                max-width: 90%;
                margin: 0 auto;
                padding: 0 2rem;
            }

            header {
                background: #1e5ba8;
                color: white;
                padding: 2.5rem 0;
            }

            .header-content {
                display: flex;
                align-items: center;
                gap: 1.5rem;
            }

            .logo-container {
                flex-shrink: 0;
            }

            .logo-container img {
                height: 80px;
                width: 80px;
                border-radius: 50%;
                border: 3px solid rgba(255, 255, 255, 0.3);
            }

            .header-text {
                flex: 1;
            }

            header h1 {
                font-size: 2.5rem;
                margin-bottom: 0.5rem;
                font-weight: 700;
            }

            header p {
                color: #e0e7ff;
                font-size: 1.125rem;
                margin-top: 0.25rem;
            }

            nav {
                background: white;
                border-bottom: 1px solid #e5e7eb;
                position: sticky;
                top: 0;
                z-index: 100;
            }

            .nav-container {
                display: flex;
                overflow-x: auto;
                gap: 0.5rem;
            }

            .nav-button {
                padding: 1.25rem 2rem;
                background: none;
                border: none;
                cursor: pointer;
                font-weight: 600;
                font-size: 1.125rem;
                color: #6b7280;
                border-bottom: 4px solid transparent;
                white-space: nowrap;
                transition: all 0.2s;
            }

            .nav-button:hover {
                color: #1e5ba8;
            }
            .nav-button.active {
                color: #1e5ba8;
                border-bottom-color: #1e5ba8;
            }

            main {
                padding: 3rem 0;
                flex: 1;
            }

            .tab-content {
                display: none;
            }
            .tab-content.active {
                display: block;
            }

            .card {
                background: transparent;
                padding: 0;
                margin-bottom: 3rem;
            }

            .belt-indicator {
                display: inline-block;
                padding: 0.75rem 2rem;
                border-radius: 0.5rem;
                font-weight: 700;
                font-size: 1.125rem;
                margin-bottom: 1.5rem;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
            }

            .card h2 {
                font-size: 2.25rem;
                margin-bottom: 1.5rem;
                font-weight: 700;
                color: #111827;
            }

            .card h3 {
                font-size: 1.75rem;
                margin-bottom: 1.25rem;
                margin-top: 2.5rem;
                color: #1e5ba8;
                font-weight: 600;
            }

            .card h4 {
                font-size: 1.375rem;
                margin-bottom: 1rem;
                margin-top: 2rem;
                color: #374151;
                font-weight: 600;
            }

            .card p {
                margin-bottom: 1.25rem;
                color: #4b5563;
                line-height: 1.8;
            }

            .sparring-section {
                background: #f9fafb;
                padding: 1.5rem;
                border-radius: 0.75rem;
                margin: 1rem 0;
                border-left: 5px solid #1e5ba8;
            }

            .sparring-section ul {
                list-style: none;
                margin-top: 0.75rem;
            }

            .sparring-section li {
                padding: 0.5rem 0;
                color: #374151;
            }

            .sparring-section .technique-name {
                color: #1e5ba8;
                font-weight: 600;
            }

            .belt-selector {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
                gap: 1.5rem;
                margin-bottom: 2.5rem;
            }

            .belt-button {
                padding: 1.25rem 1.5rem;
                border-radius: 0.75rem;
                border: none;
                cursor: pointer;
                font-weight: 600;
                font-size: 1.125rem;
                transition: all 0.2s;
                text-align: center;
                min-height: 100px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
                position: relative;
                overflow: hidden;
            }

            .belt-button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            }

            .belt-button.active {
                outline: 3px solid #1e5ba8;
                outline-offset: 2px;
            }

            .belt-button .belt-name {
                font-size: 1.2rem;
                margin-bottom: 0.25rem;
                font-weight: 700;
            }

            .belt-button .belt-color {
                font-size: 0.875rem;
                opacity: 0.9;
            }

            .belt-red {
                background: #dc2626;
                color: white;
            }
            .belt-yellow {
                background: #fbbf24;
                color: #111;
            }
            .belt-orange {
                background: #f97316;
                color: white;
            }
            .belt-green {
                background: #059669;
                color: white;
            }
            .belt-blue {
                background: #2563eb;
                color: white;
            }
            .belt-purple {
                background: #7c3aed;
                color: white;
            }
            .belt-brown {
                background: #92400e;
                color: white;
            }
            .belt-brown-white {
                background: #92400e;
                color: white;
                position: relative;
                padding-bottom: 1.75rem;
            }
            .belt-brown-white::after {
                content: "";
                position: absolute;
                bottom: 10px;
                left: 15%;
                right: 15%;
                height: 5px;
                background: white;
                border-radius: 2px;
            }
            .belt-brown-black {
                background: #92400e;
                color: white;
                position: relative;
                padding-bottom: 1.75rem;
            }
            .belt-brown-black::after {
                content: "";
                position: absolute;
                bottom: 10px;
                left: 15%;
                right: 15%;
                height: 5px;
                background: #000;
                border-radius: 2px;
            }
            .belt-black {
                background: #000;
                color: white;
            }
            .belt-black-1dan {
                background: #000;
                color: white;
                position: relative;
                padding-bottom: 1.75rem;
            }
            .belt-black-1dan::after {
                content: "";
                position: absolute;
                bottom: 10px;
                left: 15%;
                right: 15%;
                height: 5px;
                background: #fbbf24;
                border-radius: 2px;
            }
            .belt-black-2dan {
                background: #000;
                color: white;
                position: relative;
                padding-bottom: 2.5rem;
            }
            .belt-black-2dan::before {
                content: "";
                position: absolute;
                bottom: 10px;
                left: 15%;
                right: 15%;
                height: 5px;
                background: #fbbf24;
                border-radius: 2px;
            }
            .belt-black-2dan::after {
                content: "";
                position: absolute;
                bottom: 23px;
                left: 15%;
                right: 15%;
                height: 5px;
                background: #fbbf24;
                border-radius: 2px;
            }
            .belt-black-3dan {
                background: #000;
                color: white;
                position: relative;
                padding-bottom: 3.25rem;
            }
            .belt-black-3dan::before {
                content: "";
                position: absolute;
                bottom: 10px;
                left: 15%;
                right: 15%;
                height: 5px;
                background: #fbbf24;
                border-radius: 2px;
            }
            .belt-black-3dan::after {
                content: "";
                position: absolute;
                bottom: 23px;
                left: 15%;
                right: 15%;
                height: 5px;
                background: #fbbf24;
                border-radius: 2px;
            }
            .belt-black-3dan .belt-color::before {
                content: "";
                position: absolute;
                bottom: 36px;
                left: 15%;
                right: 15%;
                height: 5px;
                background: #fbbf24;
                border-radius: 2px;
            }

            .technique-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
                gap: 1.5rem;
                margin: 1.5rem 0 2rem 0;
            }

            .technique-card {
                background: white;
                padding: 1.5rem 1.75rem;
                border-radius: 0.5rem;
                border-bottom: 1px solid #e5e7eb;
                transition: all 0.2s;
            }

            .technique-card:hover {
                background: #f9fafb;
            }

            .technique-card h5 {
                font-size: 1.375rem;
                margin-bottom: 0.75rem;
                color: #111827;
                font-weight: 600;
            }

            .technique-card .japanese {
                color: #1e5ba8;
                font-weight: 600;
                margin-bottom: 0.625rem;
                font-size: 1.25rem;
            }

            .technique-card .english {
                color: #4b5563;
                font-size: 1.125rem;
                line-height: 1.7;
            }

            .technique-card .stance-info {
                font-size: 1rem;
                color: #6b7280;
                margin-top: 1rem;
                font-style: italic;
            }

            .technique-card .stance-info a {
                color: #1e5ba8;
                text-decoration: none;
                font-weight: 500;
            }

            .technique-card .stance-info a:hover {
                text-decoration: underline;
            }

            .note-box {
                background: white;
                padding: 1.5rem;
                border-radius: 0.5rem;
                border: 1px solid #e5e7eb;
                margin: 1.5rem 0 2rem 0;
                font-size: 1.125rem;
                line-height: 1.8;
            }

            .note-box strong {
                color: #1e5ba8;
                font-weight: 600;
            }

            .info-box {
                background: white;
                padding: 1.5rem;
                border-radius: 0.5rem;
                border: 1px solid #e5e7eb;
                margin: 1.5rem 0 2rem 0;
                font-size: 1.125rem;
                line-height: 1.8;
            }

            .info-box strong {
                color: #1e5ba8;
                font-weight: 600;
            }

            .dojo-kun {
                margin: 2rem 0;
            }

            .dojo-kun-item {
                background: white;
                padding: 1.5rem;
                border-radius: 0.5rem;
                border: 1px solid #e5e7eb;
                margin-bottom: 1rem;
            }

            .dojo-kun-item:last-child {
                margin-bottom: 0;
            }

            .dojo-kun-japanese {
                font-weight: 700;
                color: #1e5ba8;
                margin-bottom: 0.5rem;
                font-size: 1.25rem;
            }

            .dojo-kun-phonetic {
                color: #6b7280;
                font-style: italic;
                font-size: 1rem;
                margin-bottom: 0.75rem;
            }

            .dojo-kun-english {
                color: #374151;
                font-size: 1.125rem;
                line-height: 1.7;
            }

            .counting-grid {
                display: grid;
                grid-template-columns: repeat(5, 1fr);
                gap: 1px;
                margin: 2rem 0;
                background: #e5e7eb;
                border: 1px solid #e5e7eb;
                border-radius: 0.5rem;
                overflow: hidden;
            }

            .count-card {
                background: white;
                padding: 2rem 1rem;
                text-align: center;
            }

            .count-card:hover {
                background: #f9fafb;
            }

            .count-number {
                font-size: 1.25rem;
                font-weight: 600;
                color: #6b7280;
                margin-bottom: 0.25rem;
            }

            .count-kanji {
                font-size: 3rem;
                color: #1e5ba8;
                margin-bottom: 0.5rem;
                font-weight: 300;
            }

            .count-japanese {
                font-size: 1.25rem;
                font-weight: 600;
                color: #111827;
            }

            .belt-tying-steps {
                margin: 2rem 0;
            }

            .belt-step {
                background: white;
                padding: 1.5rem;
                border-radius: 0.5rem;
                margin-bottom: 1rem;
                border: 1px solid #e5e7eb;
                display: flex;
                gap: 1.25rem;
                align-items: flex-start;
            }

            .belt-step:last-child {
                margin-bottom: 0;
            }

            .belt-step-number {
                font-size: 1.5rem;
                font-weight: 700;
                color: #1e5ba8;
                min-width: 2.5rem;
            }

            .belt-step-text {
                color: #374151;
                font-size: 1.125rem;
                line-height: 1.8;
            }

            .stance-card {
                background: white;
                padding: 1.5rem;
                border-radius: 0.5rem;
                margin-bottom: 1rem;
                border: 1px solid #e5e7eb;
            }

            .stance-card h5 {
                font-size: 1.5rem;
                font-weight: 600;
                color: #111827;
                margin-bottom: 0.5rem;
            }

            .stance-card .stance-japanese {
                color: #1e5ba8;
                font-weight: 600;
                margin-bottom: 1rem;
                font-size: 1.125rem;
            }

            .stance-card .stance-description {
                color: #374151;
                line-height: 1.8;
                margin-bottom: 0.75rem;
                font-size: 1.125rem;
            }

            .stance-card .stance-usage {
                color: #6b7280;
                font-size: 1rem;
                font-style: italic;
                margin-top: 1rem;
                padding-top: 1rem;
                border-top: 1px solid #e5e7eb;
            }

            .btn-primary {
                background: #1e5ba8;
                color: white;
                padding: 1rem 2rem;
                border-radius: 0.625rem;
                text-decoration: none;
                display: inline-block;
                font-weight: 600;
                margin-top: 1.5rem;
                transition: all 0.2s;
                font-size: 1rem;
                border: none;
                cursor: pointer;
            }

            .btn-primary:hover {
                background: #134a8c;
            }

            /* Progress Tracking Styles */
            .belt-progress {
                display: none;
            }

            .belt-progress-fill {
                display: none;
            }

            .technique-card.learned {
                background: #f0fdf4;
                border-color: #86efac;
            }

            .learn-btn {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.5rem 1rem;
                border: 1px solid #e5e7eb;
                background: white;
                border-radius: 0.375rem;
                cursor: pointer;
                font-size: 0.875rem;
                color: #6b7280;
                margin-top: 1rem;
                transition: all 0.2s;
            }

            .learn-btn:hover {
                border-color: #1e5ba8;
                color: #1e5ba8;
            }

            .learn-btn.learned {
                background: #059669;
                border-color: #059669;
                color: white;
            }

            .progress-summary {
                background: white;
                border: 1px solid #e5e7eb;
                border-radius: 0.5rem;
                padding: 1.5rem;
                margin-bottom: 2rem;
                display: flex;
                align-items: center;
                gap: 2rem;
            }

            .progress-bar-large {
                flex: 1;
                height: 8px;
                background: #e5e7eb;
                border-radius: 4px;
                overflow: hidden;
            }

            .progress-bar-large-fill {
                height: 100%;
                background: #1e5ba8;
                border-radius: 4px;
                transition: width 0.3s ease;
            }

            .progress-text {
                font-size: 1.125rem;
                font-weight: 600;
                color: #374151;
                min-width: 120px;
            }

            .quiz-container {
                max-width: 800px;
                margin: 0 auto;
            }

            .quiz-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 2rem;
                padding: 1.5rem;
                background: #f9fafb;
                border-radius: 0.75rem;
            }

            .quiz-score {
                font-size: 1.25rem;
                font-weight: 600;
                color: #1e5ba8;
            }

            .quiz-progress {
                font-size: 1rem;
                color: #6b7280;
            }

            .quiz-question-card {
                background: white;
                padding: 3rem;
                border-radius: 0.5rem;
                border: 1px solid #e5e7eb;
                margin-bottom: 2.5rem;
                text-align: center;
            }

            .quiz-question {
                font-size: 3rem;
                font-weight: 700;
                color: #1e5ba8;
                margin-bottom: 1rem;
            }

            .quiz-type {
                font-size: 1rem;
                color: #6b7280;
                margin-bottom: 2rem;
            }

            .quiz-options {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
                margin-top: 2.5rem;
            }

            .quiz-option {
                background: white;
                padding: 1.5rem 1.25rem;
                border-radius: 0.5rem;
                border: 1px solid #e5e7eb;
                cursor: pointer;
                transition: all 0.2s;
                font-size: 1.25rem;
                font-weight: 500;
                color: #374151;
            }

            .quiz-option:hover {
                border-color: #1e5ba8;
                background: #f9fafb;
            }

            .quiz-option.correct {
                background: #dcfce7;
                border-color: #16a34a;
                color: #166534;
            }

            .quiz-option.incorrect {
                background: #fee2e2;
                border-color: #dc2626;
                color: #991b1b;
            }

            .quiz-option.disabled {
                cursor: not-allowed;
                opacity: 0.6;
            }

            .quiz-feedback {
                margin-top: 1.5rem;
                padding: 1.25rem;
                border-radius: 0.625rem;
                font-size: 1.125rem;
                font-weight: 600;
            }

            .quiz-feedback.correct {
                background: #dcfce7;
                color: #166534;
            }

            .quiz-feedback.incorrect {
                background: #fee2e2;
                color: #991b1b;
            }

            .quiz-next-btn {
                margin-top: 1.5rem;
            }

            .quiz-complete {
                text-align: center;
                padding: 3rem;
                font-size: 1.125rem;
            }

            .quiz-complete h3 {
                font-size: 2.5rem;
                margin-bottom: 1.5rem;
                color: #1e5ba8;
            }

            .quiz-complete p {
                font-size: 1.25rem;
                color: #4b5563;
                margin-bottom: 2rem;
                line-height: 1.7;
            }

            .quiz-complete label {
                font-size: 1.25rem;
                font-weight: 600;
                color: #374151;
            }

            .quiz-complete .final-score {
                font-size: 3.5rem;
                font-weight: 700;
                color: #059669;
                margin: 2rem 0;
            }

            .quiz-stats {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 1.5rem;
                margin: 2rem 0;
            }

            .quiz-stat {
                background: #f9fafb;
                padding: 1.5rem;
                border-radius: 0.75rem;
                border-left: 5px solid #1e5ba8;
            }

            .quiz-stat-value {
                font-size: 2rem;
                font-weight: 700;
                color: #1e5ba8;
                margin-bottom: 0.5rem;
            }

            .quiz-stat-label {
                font-size: 0.9375rem;
                color: #6b7280;
            }

            footer {
                background: #1f2937;
                color: white;
                padding: 2rem 0;
                text-align: center;
                margin-top: 4rem;
            }

            footer p {
                margin-bottom: 0.75rem;
                line-height: 1.6;
            }

            footer a {
                color: #93c5fd;
                text-decoration: none;
            }

            footer a:hover {
                color: #bfdbfe;
                text-decoration: underline;
            }

            /* Hamburger Menu Styles */
            .hamburger {
                display: none;
                flex-direction: column;
                justify-content: space-around;
                width: 32px;
                height: 26px;
                background: transparent;
                border: none;
                cursor: pointer;
                padding: 0;
                z-index: 200;
                -webkit-tap-highlight-color: transparent;
            }

            .hamburger span {
                display: block;
                width: 32px;
                height: 4px;
                background: #1e5ba8;
                border-radius: 3px;
                transition: all 0.3s ease;
                pointer-events: none;
            }

            .hamburger.active span:nth-child(1) {
                transform: rotate(45deg) translate(6px, 7px);
            }

            .hamburger.active span:nth-child(2) {
                opacity: 0;
            }

            .hamburger.active span:nth-child(3) {
                transform: rotate(-45deg) translate(6px, -7px);
            }

            .nav-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 99;
            }

            .nav-overlay.active {
                display: block;
            }

            /* Hide nav-label and nav-close on desktop */
            .nav-label {
                display: none;
            }

            .nav-close {
                display: none;
            }

            /* MOBILE STYLES - Using 1024px to catch all phones and tablets */
            @media screen and (max-width: 1024px) {
                /* Header adjustments */
                header {
                    padding: 1.5rem 0;
                }

                header h1 {
                    font-size: 1.5rem;
                    line-height: 1.3;
                }

                header p {
                    font-size: 0.9375rem;
                }

                .header-content {
                    flex-direction: column;
                    text-align: center;
                    gap: 1rem;
                }

                .logo-container img {
                    height: 60px;
                    width: 60px;
                }

                .container {
                    padding: 0 1rem;
                    max-width: 100%;
                }

                /* Hamburger Navigation */
                .hamburger {
                    display: flex !important;
                }

                nav {
                    position: sticky;
                    top: 0;
                    z-index: 100;
                }

                nav .container {
                    display: flex !important;
                    justify-content: space-between !important;
                    align-items: center !important;
                    padding: 0.75rem 1rem !important;
                }

                .nav-container {
                    display: flex !important;
                    position: fixed !important;
                    top: 0 !important;
                    right: -300px !important;
                    width: 280px !important;
                    height: 100vh !important;
                    height: 100dvh !important;
                    background: white !important;
                    flex-direction: column !important;
                    overflow-y: auto !important;
                    overflow-x: hidden !important;
                    z-index: 150 !important;
                    transition: right 0.3s ease !important;
                    padding: 4rem 0 2rem 0 !important;
                    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1) !important;
                    -webkit-overflow-scrolling: touch;
                }

                .nav-container.active {
                    right: 0 !important;
                }

                .nav-button {
                    display: block !important;
                    padding: 1rem 1.5rem !important;
                    text-align: left !important;
                    border-bottom: 1px solid #e5e7eb !important;
                    width: 100% !important;
                    font-size: 1rem !important;
                    white-space: nowrap !important;
                }

                .nav-button.active {
                    background: #eff6ff !important;
                    border-bottom-color: #e5e7eb !important;
                }

                .nav-label {
                    display: block !important;
                    font-weight: 600 !important;
                    color: #1e5ba8 !important;
                    font-size: 1rem !important;
                }

                .nav-close {
                    display: block !important;
                    position: absolute !important;
                    top: 1rem !important;
                    right: 1rem !important;
                    background: none !important;
                    border: none !important;
                    font-size: 2rem !important;
                    color: #374151 !important;
                    cursor: pointer !important;
                    padding: 0.5rem !important;
                    line-height: 1 !important;
                    -webkit-tap-highlight-color: transparent;
                }

                /* Main content */
                main {
                    padding: 1.5rem 0;
                }

                .card {
                    padding: 0;
                }

                .card h2 {
                    font-size: 1.5rem;
                    margin-bottom: 1rem;
                }

                .card h3 {
                    font-size: 1.25rem;
                    margin-top: 1.5rem;
                    margin-bottom: 1rem;
                }

                .card h4 {
                    font-size: 1.125rem;
                }

                .card p {
                    font-size: 1rem;
                    line-height: 1.7;
                }

                /* Belt Selector - stack on mobile */
                .belt-selector {
                    grid-template-columns: 1fr !important;
                    gap: 0.75rem !important;
                }

                .belt-button {
                    min-height: 80px !important;
                    padding: 1rem !important;
                }

                .belt-button .belt-name {
                    font-size: 1rem !important;
                }

                .belt-button .belt-color {
                    font-size: 0.875rem !important;
                }

                /* Fix striped belts on mobile */
                .belt-brown-white,
                .belt-brown-black,
                .belt-black-1dan {
                    padding-bottom: 2rem !important;
                    min-height: 90px !important;
                }
                .belt-black-2dan {
                    padding-bottom: 2.75rem !important;
                    min-height: 100px !important;
                }
                .belt-black-3dan {
                    padding-bottom: 3.5rem !important;
                    min-height: 110px !important;
                }
                .belt-brown-white::after,
                .belt-brown-black::after,
                .belt-black-1dan::after {
                    bottom: 8px !important;
                    height: 4px !important;
                }
                .belt-black-2dan::before {
                    bottom: 8px !important;
                    height: 4px !important;
                }
                .belt-black-2dan::after {
                    bottom: 18px !important;
                    height: 4px !important;
                }
                .belt-black-3dan::before {
                    bottom: 8px !important;
                    height: 4px !important;
                }
                .belt-black-3dan::after {
                    bottom: 18px !important;
                    height: 4px !important;
                }
                .belt-black-3dan .belt-color::before {
                    bottom: 28px !important;
                    height: 4px !important;
                }

                /* Technique Grid - single column on mobile */
                .technique-grid {
                    grid-template-columns: 1fr !important;
                    gap: 1rem !important;
                }

                .technique-card {
                    padding: 1.25rem;
                }

                .technique-card h5 {
                    font-size: 1.125rem;
                }

                .technique-card .japanese {
                    font-size: 1.125rem;
                }

                .technique-card .english {
                    font-size: 1rem;
                }

                /* Counting Grid - 2 columns on mobile */
                .counting-grid {
                    grid-template-columns: repeat(2, 1fr) !important;
                }

                .count-card {
                    padding: 1.25rem 0.75rem;
                }

                .count-kanji {
                    font-size: 2rem;
                }

                .count-japanese {
                    font-size: 1rem;
                }

                .count-number {
                    font-size: 0.875rem;
                }

                /* Quiz styles */
                .quiz-container {
                    padding: 0;
                }

                .quiz-header {
                    flex-direction: column;
                    gap: 1rem;
                    padding: 1rem;
                }

                .quiz-header > div {
                    text-align: center !important;
                }

                .quiz-question-card {
                    padding: 1.5rem 1rem;
                }

                .quiz-question {
                    font-size: 1.75rem;
                    word-break: break-word;
                }

                .quiz-options {
                    grid-template-columns: 1fr !important;
                    gap: 0.75rem !important;
                }

                .quiz-option {
                    padding: 1rem;
                    font-size: 1rem;
                }

                .quiz-stats {
                    grid-template-columns: repeat(2, 1fr) !important;
                    gap: 0.75rem !important;
                }

                .quiz-stat {
                    padding: 1rem;
                }

                .quiz-stat-value {
                    font-size: 1.5rem;
                }

                .quiz-complete h3 {
                    font-size: 1.75rem;
                }

                .quiz-complete .final-score {
                    font-size: 2.5rem;
                }

                #quiz-skip-btn {
                    padding: 0.65rem 1rem;
                    font-size: 0.875rem;
                }

                /* Belt slider in quiz */
                #belt-slider {
                    height: 10px !important;
                }

                #belt-badge {
                    padding: 1rem 1.5rem !important;
                    font-size: 1.25rem !important;
                }

                /* Stances */
                .stance-card {
                    padding: 1.25rem;
                }

                .stance-card h5 {
                    font-size: 1.25rem;
                }

                .stance-card .stance-japanese {
                    font-size: 1rem;
                }

                .stance-card .stance-description {
                    font-size: 1rem;
                }

                /* Dojo Kun */
                .dojo-kun-item {
                    padding: 1.25rem;
                }

                .dojo-kun-japanese {
                    font-size: 1.125rem;
                }

                .dojo-kun-english {
                    font-size: 1rem;
                }

                /* Belt tying steps */
                .belt-step {
                    flex-direction: column;
                    gap: 0.75rem;
                    padding: 1.25rem;
                }

                .belt-step-number {
                    font-size: 1.25rem;
                }

                .belt-step-text {
                    font-size: 1rem;
                }

                /* Info boxes */
                .note-box,
                .info-box {
                    padding: 1.25rem;
                    font-size: 1rem;
                }

                /* Belt indicator */
                .belt-indicator {
                    padding: 0.625rem 1.5rem;
                    font-size: 1rem;
                }

                /* Progress summary */
                .progress-summary {
                    flex-direction: column;
                    gap: 0.75rem;
                    padding: 1.25rem;
                }

                .progress-text {
                    text-align: center;
                    min-width: auto;
                }

                /* Sparring sections */
                .sparring-section {
                    padding: 1.25rem;
                }

                .sparring-section li {
                    font-size: 1rem;
                }

                /* Buttons */
                .btn-primary {
                    width: 100%;
                    text-align: center;
                    padding: 1rem 1.5rem;
                }

                /* Study mode */
                .study-mode-selector {
                    grid-template-columns: 1fr !important;
                }

                .study-mode-card {
                    padding: 1.5rem !important;
                }

                #flashcard {
                    padding: 2rem 1rem !important;
                    min-height: 200px !important;
                }

                #flashcard-term,
                #flashcard-answer {
                    font-size: 1.75rem !important;
                }

                /* Focus mode */
                #focus-terms {
                    grid-template-columns: 1fr !important;
                }

                #focus-categories {
                    grid-template-columns: 1fr !important;
                }

                /* Grading checklist */
                .training-level-box {
                    padding: 1.25rem;
                }

                .training-level-select {
                    grid-template-columns: 1fr !important;
                }

                .level-btn {
                    padding: 0.875rem;
                }

                /* Footer */
                footer {
                    padding: 1.5rem 0;
                    margin-top: 2rem;
                }

                footer p {
                    font-size: 0.9375rem;
                }

                /* Kata videos */
                .kata-videos > div {
                    grid-template-columns: 1fr !important;
                }

                /* Keyboard shortcuts box - hide on mobile */
                .quiz-start div[style*="Keyboard Shortcuts"] {
                    display: none;
                }
            }

            /* Small mobile devices */
            @media (max-width: 480px) {
                header h1 {
                    font-size: 1.25rem;
                }

                .card h2 {
                    font-size: 1.375rem;
                }

                .counting-grid {
                    grid-template-columns: repeat(2, 1fr);
                }

                .count-kanji {
                    font-size: 1.75rem;
                }

                .quiz-question {
                    font-size: 1.5rem;
                }

                .quiz-complete .final-score {
                    font-size: 2rem;
                }

                .quiz-stats {
                    grid-template-columns: 1fr;
                }
            }

            /* Tablet adjustments */
            @media (min-width: 769px) and (max-width: 1024px) {
                .belt-selector {
                    grid-template-columns: repeat(2, 1fr);
                }

                .technique-grid {
                    grid-template-columns: repeat(2, 1fr);
                }

                .counting-grid {
                    grid-template-columns: repeat(5, 1fr);
                }
            }

            .training-level-box {
                background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
                border: 2px solid #3b82f6;
                border-radius: 0.75rem;
                padding: 1.5rem;
                margin: 2rem 0;
                text-align: center;
            }

            .training-level-box h3 {
                color: #1e5ba8;
                margin-bottom: 1rem;
                font-size: 1.5rem;
            }

            .training-level-select {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 0.75rem;
                margin-top: 1rem;
            }

            .level-btn {
                padding: 1rem;
                border: 2px solid #bfdbfe;
                border-radius: 0.5rem;
                background: white;
                cursor: pointer;
                font-weight: 600;
                transition: all 0.2s;
            }

            .level-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }

            .level-btn.active {
                border-color: #1e5ba8;
                box-shadow: 0 4px 12px rgba(30, 91, 168, 0.3);
                transform: scale(1.05);
            }

            .training-info {
                margin-top: 1rem;
                padding: 1rem;
                background: white;
                border-radius: 0.5rem;
                color: #1e5ba8;
                font-weight: 600;
            }
        </style>
    </head>
    <body>
        <header>
            <div class="container">
                <div class="header-content">
                    <div class="logo-container">
                        <a
                            href="#"
                            onclick="
                                goHome();
                                return false;
                            "
                            title="Go to Belt Syllabus"
                        >
                            <img
                                src="https://hakuba-karate.co.uk/wp-content/uploads/2018/09/logo-trans-300x295.png"
                                alt="Hakuba Karate Logo"
                            />
                        </a>
                    </div>
                    <div class="header-text">
                        <h1>Hakuba Wado Ryu - Complete Learning System</h1>
                        <p>Traditional Wadoryu Atemi Jujutsu Karate - Swindon</p>
                        <p
                            style="
                                font-size: 0.875rem;
                                opacity: 0.9;
                                margin-top: 0.5rem;
                                background: rgba(255, 255, 255, 0.2);
                                display: inline-block;
                                padding: 0.25rem 0.75rem;
                                border-radius: 4px;
                            "
                        >
                            v1.2.6
                        </p>
                    </div>
                </div>
            </div>
        </header>

        <div class="nav-overlay" id="nav-overlay" onclick="toggleMobileMenu()"></div>
        <nav>
            <div class="container">
                <span class="nav-label">Menu</span>
                <button
                    class="hamburger"
                    id="hamburger"
                    onclick="toggleMobileMenu()"
                    aria-label="Toggle navigation menu"
                >
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <div class="nav-container" id="nav-container">
                    <button class="nav-close" onclick="closeMobileMenu()" aria-label="Close menu">
                        &times;
                    </button>
                    <button class="nav-button active" data-tab="belts">Belt Syllabus</button>
                    <button class="nav-button" data-tab="stances">Stances</button>
                    <button class="nav-button" data-tab="quiz">Practice Quiz</button>
                    <button class="nav-button" data-tab="belt-tying">Belt Tying</button>
                    <button class="nav-button" data-tab="counting">Counting</button>
                    <button class="nav-button" data-tab="dojo-kun">Dojo Kun</button>
                    <button class="nav-button" data-tab="terminology">Terminology</button>
                    <button class="nav-button" data-tab="study">Study Mode</button>
                    <button class="nav-button" data-tab="grading">Grading Checklist</button>
                    <button class="nav-button" data-tab="search">Search</button>
                </div>
            </div>
        </nav>

        <main>
            <div class="container">
                <!-- Belt Syllabus Tab -->
                <div id="belts-tab" class="tab-content active">
                    <div class="card">
                        <h2>Select Your Belt Level</h2>
                        <p>
                            Click on your current belt to see the complete syllabus and techniques
                            you need to learn for your next grading.
                        </p>
                    </div>

                    <!-- Overall Progress Bar (Rainbow Belt Journey) -->
                    <div
                        class="progress-summary"
                        id="overall-progress"
                        style="flex-direction: column; gap: 0.75rem"
                    >
                        <div
                            style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                width: 100%;
                                flex-wrap: wrap;
                                gap: 0.5rem;
                            "
                        >
                            <div class="progress-text" style="font-weight: 700">
                                Your Karate Journey
                            </div>
                            <div class="progress-text" id="overall-progress-text">
                                0 / 0 techniques learned
                            </div>
                        </div>
                        <div style="position: relative; width: 100%">
                            <div
                                id="rainbow-progress-bar"
                                style="
                                    height: 12px;
                                    border-radius: 6px;
                                    overflow: hidden;
                                    display: flex;
                                "
                            ></div>
                            <div
                                id="progress-marker"
                                style="
                                    position: absolute;
                                    top: -4px;
                                    width: 4px;
                                    height: 20px;
                                    background: white;
                                    border: 2px solid #374151;
                                    border-radius: 2px;
                                    transform: translateX(-50%);
                                    left: 0%;
                                    transition: left 0.3s ease;
                                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                                "
                            ></div>
                        </div>
                        <div
                            id="current-belt-label"
                            style="
                                text-align: center;
                                font-size: 0.95rem;
                                color: #374151;
                                font-weight: 600;
                            "
                        ></div>
                    </div>

                    <div class="belt-selector" id="belt-selector"></div>

                    <div id="belt-content"></div>
                </div>

                <!-- Stances Tab -->
                <div id="stances-tab" class="tab-content">
                    <div class="card">
                        <h2>Wado Ryu Stances Explained</h2>
                        <p>
                            Understanding stances is essential for performing techniques correctly.
                            Here are the key stances used in the Hakuba syllabus.
                        </p>

                        <div class="stance-card">
                            <h5>Junzuki-dachi</h5>
                            <div class="stance-japanese"> - Front Punch Stance</div>
                            <div class="stance-description">
                                <strong>Simple English:</strong> Forward fighting stance with the
                                same side forward.<br /><br />
                                <strong>Details:</strong> Front foot points straight forward, back
                                foot at about 22.5 degrees. Front knee bent over ankle, back leg
                                relatively straight. Weight distributed 50/50 between both feet.
                                This is shorter and more natural than the deep Shotokan stances.
                                Used when performing blocks and same-side techniques.
                            </div>
                            <div class="stance-usage">
                                Used for: Blocks (jodan-uke, chudan-soto-uke, chudan-uchi-uke,
                                gedan-barai)
                            </div>
                        </div>

                        <div class="stance-card">
                            <h5>Hanmi-gamae</h5>
                            <div class="stance-japanese"> - Half-Body Fighting Stance</div>
                            <div class="stance-description">
                                <strong>Simple English:</strong> Natural fighting stance, ready
                                position.<br /><br />
                                <strong>Details:</strong> A relaxed, natural fighting stance with
                                your body turned at an angle (hanmi means "half body"). Feet are
                                positioned naturally, knees slightly bent, weight balanced. Hands up
                                in guard position. This is your "ready to go" stance - mobile and
                                prepared to attack or defend.
                            </div>
                            <div class="stance-usage">
                                Used for: Strikes, kicks, and all dynamic techniques (punches, front
                                kicks, roundhouse kicks)
                            </div>
                        </div>

                        <div class="stance-card">
                            <h5>Gyakuzuki-dachi</h5>
                            <div class="stance-japanese"> - Reverse Punch Stance</div>
                            <div class="stance-description">
                                <strong>Simple English:</strong> Forward stance with opposite side
                                forward.<br /><br />
                                <strong>Details:</strong> Similar to Junzuki-dachi but used when
                                performing reverse punch (opposite hand to forward leg). Front foot
                                points slightly inward. This stance helps generate power from hip
                                rotation for the reverse punch.
                            </div>
                            <div class="stance-usage">Used for: Reverse punches (gyakuzuki)</div>
                        </div>

                        <div class="info-box">
                            <strong>Key Difference:</strong> Junzuki-dachi is used when you punch
                            with the same side as your forward leg (left leg forward, left punch).
                            Hanmi-gamae is your natural fighting stance where you're ready to do
                            anything. Think of Junzuki-dachi as your "blocking stance" and
                            Hanmi-gamae as your "ready to attack stance".
                        </div>
                    </div>
                </div>

                <!-- Practice Quiz Tab -->
                <div id="quiz-tab" class="tab-content">
                    <div class="card">
                        <h2>Practice Quiz</h2>
                        <p>
                            Test your knowledge of Japanese karate terminology! Select the correct
                            English translation for each term.
                        </p>

                        <div class="quiz-container">
                            <div id="quiz-start" class="quiz-complete">
                                <h3>Ready to Practice?</h3>
                                <p style="color: #6b7280; margin-bottom: 2rem">
                                    Test your knowledge of Japanese karate terminology! Select your
                                    current belt level to get appropriate questions.
                                </p>

                                <div style="max-width: 700px; margin: 0 auto 2rem auto">
                                    <label
                                        style="
                                            display: block;
                                            font-weight: 600;
                                            margin-bottom: 1rem;
                                            color: #374151;
                                            text-align: center;
                                            font-size: 1.375rem;
                                        "
                                        >Select Your Current Belt Level:</label
                                    >
                                    <p
                                        style="
                                            text-align: center;
                                            color: #4b5563;
                                            font-size: 1.125rem;
                                            margin-bottom: 1.5rem;
                                        "
                                    >
                                        Quiz will test you on everything up to and including this
                                        belt
                                    </p>

                                    <div style="position: relative; margin-bottom: 2rem">
                                        <input
                                            type="range"
                                            id="belt-slider"
                                            min="0"
                                            max="11"
                                            value="1"
                                            step="1"
                                            style="
                                                width: 100%;
                                                height: 8px;
                                                border-radius: 4px;
                                                background: linear-gradient(
                                                    to right,
                                                    #dc2626 0%,
                                                    #fbbf24 20%,
                                                    #f97316 30%,
                                                    #059669 40%,
                                                    #2563eb 50%,
                                                    #7c3aed 60%,
                                                    #92400e 100%
                                                );
                                                outline: none;
                                                -webkit-appearance: none;
                                                appearance: none;
                                                cursor: pointer;
                                            "
                                            oninput="updateBeltDisplay()"
                                        />
                                    </div>

                                    <div
                                        id="selected-belt-display"
                                        style="text-align: center; margin-bottom: 1rem"
                                    >
                                        <div
                                            style="
                                                display: inline-block;
                                                padding: 1.25rem 2.5rem;
                                                border-radius: 0.75rem;
                                                font-weight: 700;
                                                font-size: 1.5rem;
                                                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
                                            "
                                            id="belt-badge"
                                        >
                                            8th Ky - Yellow Belt
                                        </div>
                                    </div>

                                    <div
                                        id="included-belts"
                                        style="
                                            text-align: center;
                                            font-size: 1.125rem;
                                            color: #4b5563;
                                            margin-bottom: 1rem;
                                        "
                                    >
                                        Testing: Red, Yellow
                                    </div>

                                    <div
                                        id="question-count"
                                        style="
                                            text-align: center;
                                            font-size: 1.125rem;
                                            color: #059669;
                                            font-weight: 600;
                                        "
                                    >
                                        ~25 available questions
                                    </div>
                                </div>

                                <style>
                                    #belt-slider::-webkit-slider-thumb {
                                        -webkit-appearance: none;
                                        appearance: none;
                                        width: 24px;
                                        height: 24px;
                                        border-radius: 50%;
                                        background: white;
                                        border: 3px solid #dc2626;
                                        cursor: pointer;
                                        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                                    }
                                    #belt-slider::-moz-range-thumb {
                                        width: 24px;
                                        height: 24px;
                                        border-radius: 50%;
                                        background: white;
                                        border: 3px solid #dc2626;
                                        cursor: pointer;
                                        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                                    }
                                    #belt-badge.belt-red {
                                        background: #dc2626;
                                        color: white;
                                    }
                                    #belt-badge.belt-yellow {
                                        background: #fbbf24;
                                        color: #111;
                                    }
                                    #belt-badge.belt-orange {
                                        background: #f97316;
                                        color: white;
                                    }
                                    #belt-badge.belt-green {
                                        background: #059669;
                                        color: white;
                                    }
                                    #belt-badge.belt-blue {
                                        background: #2563eb;
                                        color: white;
                                    }
                                    #belt-badge.belt-purple {
                                        background: #7c3aed;
                                        color: white;
                                    }
                                    #belt-badge.belt-brown {
                                        background: #92400e;
                                        color: white;
                                    }
                                    #belt-badge.belt-brown-white {
                                        background: linear-gradient(
                                            to bottom,
                                            #92400e 0%,
                                            #92400e 40%,
                                            white 40%,
                                            white 50%,
                                            #92400e 50%,
                                            #92400e 100%
                                        );
                                        color: white;
                                    }
                                    #belt-badge.belt-brown-black {
                                        background: linear-gradient(
                                            to bottom,
                                            #92400e 0%,
                                            #92400e 40%,
                                            #000 40%,
                                            #000 50%,
                                            #92400e 50%,
                                            #92400e 100%
                                        );
                                        color: white;
                                    }
                                    #belt-badge.belt-black-1dan {
                                        background: linear-gradient(
                                            to bottom,
                                            #000 0%,
                                            #000 15%,
                                            #fbbf24 15%,
                                            #fbbf24 20%,
                                            #000 20%,
                                            #000 100%
                                        );
                                        color: white;
                                    }
                                    #belt-badge.belt-black-2dan {
                                        background: linear-gradient(
                                            to bottom,
                                            #000 0%,
                                            #000 12%,
                                            #fbbf24 12%,
                                            #fbbf24 17%,
                                            #000 17%,
                                            #000 22%,
                                            #fbbf24 22%,
                                            #fbbf24 27%,
                                            #000 27%,
                                            #000 100%
                                        );
                                        color: white;
                                    }
                                    #belt-badge.belt-black-3dan {
                                        background: linear-gradient(
                                            to bottom,
                                            #000 0%,
                                            #000 10%,
                                            #fbbf24 10%,
                                            #fbbf24 14%,
                                            #000 14%,
                                            #000 18%,
                                            #fbbf24 18%,
                                            #fbbf24 22%,
                                            #000 22%,
                                            #000 26%,
                                            #fbbf24 26%,
                                            #fbbf24 30%,
                                            #000 30%,
                                            #000 100%
                                        );
                                        color: white;
                                    }

                                    .training-level-box {
                                        background: linear-gradient(
                                            135deg,
                                            #eff6ff 0%,
                                            #dbeafe 100%
                                        );
                                        border: 2px solid #3b82f6;
                                        border-radius: 0.75rem;
                                        padding: 1.5rem;
                                        margin: 2rem 0;
                                        text-align: center;
                                    }

                                    .training-level-box h3 {
                                        color: #1e5ba8;
                                        margin-bottom: 1rem;
                                        font-size: 1.5rem;
                                    }

                                    .training-level-select {
                                        display: grid;
                                        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                                        gap: 0.75rem;
                                        margin-top: 1rem;
                                    }

                                    .level-btn {
                                        padding: 1rem;
                                        border: 2px solid #bfdbfe;
                                        border-radius: 0.5rem;
                                        background: white;
                                        cursor: pointer;
                                        font-weight: 600;
                                        transition: all 0.2s;
                                    }

                                    .level-btn:hover {
                                        transform: translateY(-2px);
                                        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                                    }

                                    .level-btn.active {
                                        border-color: #1e5ba8;
                                        box-shadow: 0 4px 12px rgba(30, 91, 168, 0.3);
                                        transform: scale(1.05);
                                    }

                                    .training-info {
                                        margin-top: 1rem;
                                        padding: 1rem;
                                        background: white;
                                        border-radius: 0.5rem;
                                        color: #1e5ba8;
                                        font-weight: 600;
                                    }
                                </style>

                                <div
                                    style="
                                        background: #f9fafb;
                                        padding: 1.75rem;
                                        border-radius: 0.75rem;
                                        max-width: 550px;
                                        margin: 0 auto 2rem auto;
                                        border-left: 6px solid #2563eb;
                                    "
                                >
                                    <div
                                        style="
                                            font-weight: 600;
                                            color: #111827;
                                            margin-bottom: 1rem;
                                            font-size: 1.25rem;
                                        "
                                    >
                                        Keyboard Shortcuts:
                                    </div>
                                    <div
                                        style="
                                            font-size: 1.125rem;
                                            color: #4b5563;
                                            line-height: 1.8;
                                        "
                                    >
                                        <strong>1-4</strong> = Select answer<br />
                                        <strong>S</strong> = Skip question<br />
                                        <strong>Enter</strong> = Next question<br />
                                        <strong>Esc</strong> = Exit quiz
                                    </div>
                                </div>

                                <button onclick="startQuiz()" class="btn-primary">
                                    Start Quiz
                                </button>
                            </div>

                            <div id="quiz-active" style="display: none">
                                <div class="quiz-header">
                                    <div>
                                        <div class="quiz-score">
                                            Score: <span id="quiz-score">0</span>
                                        </div>
                                        <div class="quiz-progress">
                                            Question <span id="quiz-current">1</span> of
                                            <span id="quiz-total">10</span>
                                        </div>
                                    </div>
                                    <div style="text-align: right">
                                        <div
                                            id="quiz-difficulty-display"
                                            style="
                                                font-size: 0.875rem;
                                                color: #6b7280;
                                                margin-bottom: 0.5rem;
                                            "
                                        ></div>
                                        <button
                                            onclick="exitQuiz()"
                                            style="
                                                background: #6b7280;
                                                color: white;
                                                border: none;
                                                padding: 0.5rem 1rem;
                                                border-radius: 0.5rem;
                                                cursor: pointer;
                                                font-size: 0.875rem;
                                                font-weight: 500;
                                                transition: all 0.2s;
                                            "
                                            onmouseover="this.style.background = '#4b5563'"
                                            onmouseout="this.style.background = '#6b7280'"
                                        >
                                            Exit Quiz
                                        </button>
                                    </div>
                                </div>

                                <div
                                    class="quiz-progress-bar"
                                    style="
                                        background: #e5e7eb;
                                        height: 8px;
                                        border-radius: 4px;
                                        margin-bottom: 2rem;
                                        overflow: hidden;
                                    "
                                >
                                    <div
                                        id="quiz-progress-fill"
                                        style="
                                            background: #dc2626;
                                            height: 100%;
                                            width: 0%;
                                            transition: width 0.3s;
                                        "
                                    ></div>
                                </div>

                                <div class="quiz-question-card">
                                    <div class="quiz-type" id="quiz-category"></div>
                                    <div class="quiz-question" id="quiz-question"></div>
                                    <p style="color: #6b7280; margin-top: 0.5rem">
                                        What does this mean in English?
                                    </p>

                                    <div class="quiz-options" id="quiz-options"></div>

                                    <div id="quiz-feedback" style="display: none"></div>
                                    <div
                                        style="
                                            display: flex;
                                            gap: 1rem;
                                            justify-content: center;
                                            margin-top: 1.5rem;
                                            flex-wrap: wrap;
                                        "
                                    >
                                        <button
                                            id="quiz-skip-btn"
                                            onclick="skipQuestion()"
                                            style="
                                                background: #6b7280;
                                                padding: 0.75rem 1.5rem;
                                                border-radius: 0.625rem;
                                                color: white;
                                                border: none;
                                                cursor: pointer;
                                                font-size: 0.9375rem;
                                                font-weight: 500;
                                                transition: all 0.2s;
                                            "
                                            onmouseover="this.style.background = '#4b5563'"
                                            onmouseout="this.style.background = '#6b7280'"
                                        >
                                            Skip (Press S)
                                        </button>
                                        <button
                                            id="quiz-next-btn"
                                            onclick="nextQuestion()"
                                            class="btn-primary"
                                            style="display: none; margin-top: 0"
                                        >
                                            Next Question (Press Enter) 
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div id="quiz-complete" class="quiz-complete" style="display: none">
                                <h3>Quiz Complete! </h3>
                                <div class="final-score"><span id="final-score">0</span>%</div>
                                <p style="color: #6b7280; margin-bottom: 2rem">
                                    Great work practising your Japanese terminology!
                                </p>

                                <div class="quiz-stats">
                                    <div class="quiz-stat">
                                        <div class="quiz-stat-value" id="correct-count">0</div>
                                        <div class="quiz-stat-label">Correct</div>
                                    </div>
                                    <div class="quiz-stat">
                                        <div class="quiz-stat-value" id="incorrect-count">0</div>
                                        <div class="quiz-stat-label">Incorrect</div>
                                    </div>
                                    <div class="quiz-stat">
                                        <div class="quiz-stat-value" id="skipped-count">0</div>
                                        <div class="quiz-stat-label">Skipped</div>
                                    </div>
                                    <div class="quiz-stat">
                                        <div class="quiz-stat-value" id="total-count">10</div>
                                        <div class="quiz-stat-label">Total</div>
                                    </div>
                                </div>

                                <div
                                    id="category-breakdown"
                                    style="
                                        background: #f9fafb;
                                        padding: 1.5rem;
                                        border-radius: 0.75rem;
                                        margin: 2rem 0;
                                        text-align: left;
                                    "
                                ></div>

                                <div
                                    style="
                                        display: flex;
                                        flex-wrap: wrap;
                                        gap: 1rem;
                                        justify-content: center;
                                    "
                                >
                                    <button
                                        onclick="startQuiz()"
                                        class="btn-primary"
                                        style="width: auto"
                                    >
                                        Try Again
                                    </button>
                                    <button
                                        onclick="exitQuiz()"
                                        style="background: #6b7280; width: auto"
                                        class="btn-primary"
                                    >
                                        Change Level
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Belt Tying Tab -->
                <div id="belt-tying-tab" class="tab-content">
                    <div class="card">
                        <h2>Hon-Musubi () - Traditional Wado Ryu Belt Tying</h2>

                        <p>
                            Hon-Musubi is the traditional Wado Ryu method of tying your belt (obi),
                            as taught by Hironori Ohtsuka. This technique is tested at 9th and 8th
                            Ky gradings and should become second nature.
                        </p>

                        <div class="info-box">
                            <strong>Important:</strong> The way you tie your belt demonstrates
                            discipline, respect, and attention to detail - core values of Wado Ryu
                            karate. Take time to learn this properly.
                        </div>

                        <h3>Step-by-Step Instructions</h3>

                        <div class="belt-tying-steps">
                            <div class="belt-step">
                                <div class="belt-step-number">Step 1: Find the Centre</div>
                                <div class="belt-step-text">
                                    Fold your belt in half to find the middle point. Hold this
                                    centre point against your abdomen, around belly button height.
                                </div>
                            </div>

                            <div class="belt-step">
                                <div class="belt-step-number">Step 2: Wrap Around</div>
                                <div class="belt-step-text">
                                    Wrap both ends of the belt around your waist to the back,
                                    keeping the belt flat against your body. The ends should be
                                    roughly equal length when they meet at the back.
                                </div>
                            </div>

                            <div class="belt-step">
                                <div class="belt-step-number">Step 3: Bring to Front</div>
                                <div class="belt-step-text">
                                    Bring both ends back to the front. Cross the right end over the
                                    left end in front of your body.
                                </div>
                            </div>

                            <div class="belt-step">
                                <div class="belt-step-number">Step 4: Tuck Under</div>
                                <div class="belt-step-text">
                                    Take the right end and tuck it under BOTH layers of the belt
                                    (between your gi and the belt), pulling it up through the
                                    centre. This is the key step that distinguishes Hon-Musubi.
                                </div>
                            </div>

                            <div class="belt-step">
                                <div class="belt-step-number">Step 5: Create the Knot</div>
                                <div class="belt-step-text">
                                    Now take the top end (that you just pulled through) and place it
                                    over the bottom end, forming a loop. Thread the top end through
                                    this loop from above.
                                </div>
                            </div>

                            <div class="belt-step">
                                <div class="belt-step-number">Step 6: Tighten</div>
                                <div class="belt-step-text">
                                    Pull both ends evenly to tighten the knot. The knot should sit
                                    flat and square against your abdomen. Both ends should hang down
                                    evenly, roughly the same length.
                                </div>
                            </div>
                        </div>

                        <div class="note-box">
                            <strong>Practice Tip:</strong> The finished knot should be a square knot
                            (koma-musubi) that sits flat and neat. Both ends should hang at roughly
                            the same length. Practice this daily until it becomes automatic!
                        </div>
                    </div>
                </div>

                <!-- Counting Tab -->
                <div id="counting-tab" class="tab-content">
                    <div class="card">
                        <h2>Japanese Counting (1-10)</h2>
                        <p>
                            Essential numbers used in training, gradings, and kata. You'll hear
                            these constantly in the dojo, so memorise them early!
                        </p>

                        <div class="counting-grid">
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Ichi / Ipponme</div>
                                <div class="count-number">1 / 1st</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Ni / Nihonme</div>
                                <div class="count-number">2 / 2nd</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">San / Sanbonme</div>
                                <div class="count-number">3 / 3rd</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Shi / Yonhonme</div>
                                <div class="count-number">4 / 4th</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Go / Gohonme</div>
                                <div class="count-number">5 / 5th</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Roku / Ropponme</div>
                                <div class="count-number">6 / 6th</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Shichi / Nanahonme</div>
                                <div class="count-number">7 / 7th</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Hachi / Napponme</div>
                                <div class="count-number">8 / 8th</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Ky</div>
                                <div class="count-number">9</div>
                            </div>
                            <div class="count-card">
                                <div class="count-kanji"></div>
                                <div class="count-japanese">Jy</div>
                                <div class="count-number">10</div>
                            </div>
                        </div>

                        <div class="info-box">
                            <strong>Note:</strong> The ordinal numbers (1st, 2nd, 3rd, etc.) are
                            used in sparring sequences. For example, "Ipponme" means "the first
                            technique", "Gohonme" means "the fifth technique".
                        </div>
                    </div>
                </div>

                <!-- Dojo Kun Tab -->
                <div id="dojo-kun-tab" class="tab-content">
                    <div class="card">
                        <h2>Dojo Kun ()</h2>
                        <p>
                            The five principles of the dojo - recited in Japanese and English at ALL
                            gradings. These represent the philosophical foundation of your training.
                        </p>

                        <div class="dojo-kun">
                            <div class="dojo-kun-item">
                                <div class="dojo-kun-japanese">REISETSU-O-MAMORI</div>
                                <div class="dojo-kun-phonetic">Ray-sets-o ma-mory</div>
                                <div class="dojo-kun-english">Stick to the rules of the Dojo.</div>
                            </div>
                            <div class="dojo-kun-item">
                                <div class="dojo-kun-japanese">SHINGI-O-OMANJI</div>
                                <div class="dojo-kun-phonetic">Shin-gee o oman-jee</div>
                                <div class="dojo-kun-english">Be loyal to your Instructor.</div>
                            </div>
                            <div class="dojo-kun-item">
                                <div class="dojo-kun-japanese">JOJITSU-NI-OBERESU</div>
                                <div class="dojo-kun-phonetic">Joe-jitsu nee obberezu</div>
                                <div class="dojo-kun-english">
                                    Students and Instructors are not all one; never take advantage
                                    of his friendship.
                                </div>
                            </div>
                            <div class="dojo-kun-item">
                                <div class="dojo-kun-japanese">SHINKENMI-NI-TESSEYO</div>
                                <div class="dojo-kun-phonetic">Shin-ken-mee nee tesseyo</div>
                                <div class="dojo-kun-english">Be serious in your efforts.</div>
                            </div>
                        </div>

                        <div class="note-box">
                            <strong>Grading Requirement:</strong> You must be able to recite the
                            Dojo Kun in both Japanese and English at all gradings, starting from 9th
                            Ky.
                        </div>

                        <a
                            href="https://hakuba-karate.co.uk/dojo-kun/"
                            target="_blank"
                            class="btn-primary"
                            >Read More About Dojo Kun </a
                        >
                    </div>
                </div>

                <!-- Terminology Tab -->
                <div id="terminology-tab" class="tab-content">
                    <div class="card">
                        <h2>Complete Terminology Reference</h2>
                        <p>
                            All Japanese terms used in training, organized by category. From 7th Ky
                            onwards, all commands are given in Japanese only!
                        </p>

                        <h3>Commands</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Yi ()</div>
                                <div class="english">
                                    Ready / Prepare - Stand in a ready position
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Rei ()</div>
                                <div class="english">
                                    Bow / Show respect - Formal bow to sensei or partner
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Hajime ()</div>
                                <div class="english">Begin - Start the technique or exercise</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Yame ()</div>
                                <div class="english">Stop / Cease - Return to ready position</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Mawatte ()</div>
                                <div class="english">Turn around - Usually 180 degrees</div>
                            </div>
                        </div>

                        <h3>Levels & Positions</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Jodan ()</div>
                                <div class="english">
                                    Upper level - Head height attacks and blocks
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Chudan ()</div>
                                <div class="english">
                                    Middle level - Body (chest/abdomen) techniques
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Gedan ()</div>
                                <div class="english">Lower level - Below the waist techniques</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Hidari ()</div>
                                <div class="english">Left - Left side or left hand/foot</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Migi ()</div>
                                <div class="english">Right - Right side or right hand/foot</div>
                            </div>
                        </div>

                        <h3>Blocks (Uke )</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Jodan-uke ()</div>
                                <div class="english">
                                    Head block - Rising block to protect the head
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Chudan-soto-uke ()</div>
                                <div class="english">
                                    Body outer block - Outside-to-inside block at body level
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Chudan-uchi-uke ()</div>
                                <div class="english">
                                    Body inner block - Inside-to-outside block at body level
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Gedan-barai ()</div>
                                <div class="english">
                                    Lower sweeping block - Downward block to deflect low attacks
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Morote-uke ()</div>
                                <div class="english">
                                    Double-hand block - Reinforced block using both hands
                                </div>
                            </div>
                        </div>

                        <h3>Punches & Strikes (Zuki/Tsuki )</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Junzuki ()</div>
                                <div class="english">
                                    Straight punch - Same-side punch (same hand and foot forward)
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Gyakuzuki ()</div>
                                <div class="english">
                                    Reverse punch - Opposite hand to forward leg
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Tobikomizuki ()</div>
                                <div class="english">Snap punch - Jumping/lunging punch</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Nagashizuki ()</div>
                                <div class="english">
                                    Deflecting punch - Flowing/deflecting punch
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Uraken-uchi ()</div>
                                <div class="english">
                                    Back fist strike - Strike using the back of the fist
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Empi ()</div>
                                <div class="english">
                                    Elbow strike - Close-range elbow technique
                                </div>
                            </div>
                        </div>

                        <h3>Kicks (Geri )</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Maegeri ()</div>
                                <div class="english">Front kick - Kick straight to the front</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Mawashigeri ()</div>
                                <div class="english">
                                    Roundhouse kick - Circular kick to the side
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Sokuto ()</div>
                                <div class="english">
                                    Side edge kick - Kick using the blade edge of the foot
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Ushirogeri ()</div>
                                <div class="english">Back kick - Kick directed backwards</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Nidangeri ()</div>
                                <div class="english">
                                    Double level kick - Two kicks at different heights
                                </div>
                            </div>
                        </div>

                        <h3>Stances (Dachi )</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Junzuki-dachi ()</div>
                                <div class="english">
                                    Front punch stance - Forward stance for straight punching
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Gyakuzuki-dachi ()</div>
                                <div class="english">
                                    Reverse punch stance - Stance for reverse punching
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Hanmi-gamae ()</div>
                                <div class="english">
                                    Half-body fighting stance - Side-on fighting position
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Zenkutsu-dachi ()</div>
                                <div class="english">
                                    Forward-leaning stance - Long stance with weight forward
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Kokutsu-dachi ()</div>
                                <div class="english">Back stance - Weight on the rear leg</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Kiba-dachi ()</div>
                                <div class="english">
                                    Horse riding stance - Wide stance with weight centered
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Shiko-dachi ()</div>
                                <div class="english">
                                    Sumo stance - Wide square stance with feet turned out
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Neko-ashi-dachi ()</div>
                                <div class="english">
                                    Cat stance - Most weight on back leg, front foot light
                                </div>
                            </div>
                        </div>

                        <h3>Modifiers</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Surikomi ()</div>
                                <div class="english">One step - Single step forward technique</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">No-tsukkomi ()</div>
                                <div class="english">Leaning - Leaning body movement</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Kette ()</div>
                                <div class="english">Stepping - Stepping movement</div>
                            </div>
                        </div>

                        <h3>Sparring (Kumite )</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Sanbon-Gumite ()</div>
                                <div class="english">
                                    Three-step sparring - Pre-arranged three-attack sequence
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Kihon-Gumite ()</div>
                                <div class="english">
                                    Basic sparring - Fundamental sparring practice
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Ohyo-Gumite ()</div>
                                <div class="english">
                                    Application sparring - Applied technique sparring
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Jiyu-Gumite ()</div>
                                <div class="english">
                                    Free sparring - Unrestricted sparring practice
                                </div>
                            </div>
                        </div>

                        <h3>Counting (1-10)</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Ichi ()</div>
                                <div class="english">One</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Ni ()</div>
                                <div class="english">Two</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">San ()</div>
                                <div class="english">Three</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Shi/Yon ()</div>
                                <div class="english">Four</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Go ()</div>
                                <div class="english">Five</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Roku ()</div>
                                <div class="english">Six</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Shichi/Nana ()</div>
                                <div class="english">Seven</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Hachi ()</div>
                                <div class="english">Eight</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Ky ()</div>
                                <div class="english">Nine</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">J ()</div>
                                <div class="english">Ten</div>
                            </div>
                        </div>

                        <h3>Technique Numbering</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Ipponme ()</div>
                                <div class="english">First technique</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Nihonme ()</div>
                                <div class="english">Second technique</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Sanbonme ()</div>
                                <div class="english">Third technique</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Yonhonme ()</div>
                                <div class="english">Fourth technique</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Gohonme ()</div>
                                <div class="english">Fifth technique</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Ropponme ()</div>
                                <div class="english">Sixth technique</div>
                            </div>
                        </div>

                        <h3>General Terms</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Dojo ()</div>
                                <div class="english">
                                    Training hall - The place where we practice
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Sensei ()</div>
                                <div class="english">
                                    Instructor / Teacher - Literally "one who came before"
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Kata ()</div>
                                <div class="english">Form - Pre-arranged sequence of movements</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Kihon ()</div>
                                <div class="english">Basics - Fundamental techniques</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Kumite ()</div>
                                <div class="english">Sparring - Partner practice</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Waza ()</div>
                                <div class="english">Technique - A specific move or skill</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Uke ()</div>
                                <div class="english">
                                    Block - Defensive technique to deflect attacks
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Gi ()</div>
                                <div class="english">Uniform - The karate training suit</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Obi ()</div>
                                <div class="english">
                                    Belt - Worn around the waist to indicate rank
                                </div>
                            </div>
                        </div>

                        <h3>Wado-Ryu Principles</h3>
                        <div class="technique-grid">
                            <div class="technique-card">
                                <div class="japanese">Maai ()</div>
                                <div class="english">
                                    Distance/timing - The optimal distance and timing between
                                    opponents
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Kuzushi ()</div>
                                <div class="english">
                                    Off-balancing - Breaking the opponent's balance
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Tai sabaki ()</div>
                                <div class="english">Body shifting - Evasive body movement</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Nagasu ()</div>
                                <div class="english">Flowing - To let an attack flow past</div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Inasu ()</div>
                                <div class="english">
                                    Deflecting - To deflect or redirect an attack
                                </div>
                            </div>
                            <div class="technique-card">
                                <div class="japanese">Noru ()</div>
                                <div class="english">
                                    Riding - Moving with the opponent's attack
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Study Mode Tab -->
                <div id="study-tab" class="tab-content">
                    <div class="card">
                        <h2>Study Mode</h2>
                        <p>
                            Choose a study mode to practice your karate terminology. Flashcards help
                            you memorise terms, while Focus Mode lets you study specific technique
                            categories.
                        </p>

                        <div
                            class="study-mode-selector"
                            style="
                                display: grid;
                                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                                gap: 1.5rem;
                                margin: 2rem 0;
                            "
                        >
                            <div
                                class="study-mode-card"
                                style="
                                    background: white;
                                    border: 1px solid #e5e7eb;
                                    border-radius: 0.5rem;
                                    padding: 2rem;
                                    text-align: center;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                "
                                onclick="startFlashcards()"
                            >
                                <div style="font-size: 3rem; margin-bottom: 1rem"></div>
                                <h3 style="margin-bottom: 0.5rem; color: #1e5ba8">
                                    Flashcard Mode
                                </h3>
                                <p style="color: #6b7280; font-size: 1rem">
                                    Flip through cards to test your memory. See the Japanese term,
                                    then reveal the English translation.
                                </p>
                            </div>
                            <div
                                class="study-mode-card"
                                style="
                                    background: white;
                                    border: 1px solid #e5e7eb;
                                    border-radius: 0.5rem;
                                    padding: 2rem;
                                    text-align: center;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                "
                                onclick="startFocusMode()"
                            >
                                <div style="font-size: 3rem; margin-bottom: 1rem"></div>
                                <h3 style="margin-bottom: 0.5rem; color: #1e5ba8">Focus Mode</h3>
                                <p style="color: #6b7280; font-size: 1rem">
                                    Study specific categories like blocks, kicks, or commands.
                                    Perfect for targeted practice.
                                </p>
                            </div>
                        </div>

                        <!-- Flashcard Container -->
                        <div id="flashcard-container" style="display: none">
                            <div
                                style="
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                    margin-bottom: 1.5rem;
                                "
                            >
                                <h3 style="margin: 0">Flashcards</h3>
                                <button
                                    onclick="exitStudyMode()"
                                    style="
                                        background: #6b7280;
                                        color: white;
                                        border: none;
                                        padding: 0.5rem 1rem;
                                        border-radius: 0.5rem;
                                        cursor: pointer;
                                    "
                                >
                                    Exit
                                </button>
                            </div>

                            <div style="margin-bottom: 1.5rem">
                                <label style="font-weight: 600; margin-right: 1rem"
                                    >Select Belt Level:</label
                                >
                                <select
                                    id="flashcard-belt"
                                    onchange="loadFlashcards()"
                                    style="
                                        padding: 0.5rem 1rem;
                                        border: 1px solid #e5e7eb;
                                        border-radius: 0.375rem;
                                        font-size: 1rem;
                                    "
                                ></select>
                            </div>

                            <div
                                id="flashcard-progress"
                                style="text-align: center; color: #6b7280; margin-bottom: 1rem"
                            ></div>

                            <div
                                id="flashcard"
                                style="
                                    background: white;
                                    border: 1px solid #e5e7eb;
                                    border-radius: 0.75rem;
                                    padding: 3rem;
                                    text-align: center;
                                    min-height: 250px;
                                    cursor: pointer;
                                    transition: all 0.3s;
                                    position: relative;
                                "
                                onclick="flipFlashcard()"
                            >
                                <div
                                    id="flashcard-front"
                                    style="
                                        display: flex;
                                        flex-direction: column;
                                        justify-content: center;
                                        min-height: 180px;
                                    "
                                >
                                    <div
                                        id="flashcard-category"
                                        style="
                                            font-size: 0.875rem;
                                            color: #6b7280;
                                            margin-bottom: 1rem;
                                        "
                                    ></div>
                                    <div
                                        id="flashcard-term"
                                        style="font-size: 2.5rem; font-weight: 700; color: #1e5ba8"
                                    ></div>
                                    <div
                                        style="
                                            font-size: 0.875rem;
                                            color: #9ca3af;
                                            margin-top: 1.5rem;
                                        "
                                    >
                                        Click to reveal answer
                                    </div>
                                </div>
                                <div
                                    id="flashcard-back"
                                    style="
                                        display: none;
                                        flex-direction: column;
                                        justify-content: center;
                                        min-height: 180px;
                                    "
                                >
                                    <div
                                        id="flashcard-term-back"
                                        style="
                                            font-size: 1.5rem;
                                            color: #6b7280;
                                            margin-bottom: 0.5rem;
                                        "
                                    ></div>
                                    <div
                                        id="flashcard-answer"
                                        style="font-size: 2.5rem; font-weight: 700; color: #059669"
                                    ></div>
                                </div>
                            </div>

                            <div
                                style="
                                    display: flex;
                                    justify-content: center;
                                    gap: 1rem;
                                    margin-top: 1.5rem;
                                "
                            >
                                <button
                                    onclick="prevFlashcard()"
                                    class="btn-primary"
                                    style="background: #6b7280"
                                >
                                     Previous
                                </button>
                                <button
                                    onclick="shuffleFlashcards()"
                                    class="btn-primary"
                                    style="background: #7c3aed"
                                >
                                    Shuffle
                                </button>
                                <button onclick="nextFlashcard()" class="btn-primary">
                                    Next 
                                </button>
                            </div>

                            <div
                                style="
                                    background: #f9fafb;
                                    padding: 1.5rem;
                                    border-radius: 0.5rem;
                                    margin-top: 2rem;
                                    text-align: center;
                                "
                            >
                                <div style="font-weight: 600; margin-bottom: 0.5rem">
                                    Keyboard Shortcuts:
                                </div>
                                <div style="color: #6b7280">
                                    <strong>Space</strong> = Flip card | <strong>/</strong> =
                                    Navigate | <strong>S</strong> = Shuffle | <strong>Esc</strong> =
                                    Exit
                                </div>
                            </div>
                        </div>

                        <!-- Focus Mode Container -->
                        <div id="focus-container" style="display: none">
                            <div
                                style="
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                    margin-bottom: 1.5rem;
                                "
                            >
                                <h3 style="margin: 0">Focus Mode</h3>
                                <button
                                    onclick="exitStudyMode()"
                                    style="
                                        background: #6b7280;
                                        color: white;
                                        border: none;
                                        padding: 0.5rem 1rem;
                                        border-radius: 0.5rem;
                                        cursor: pointer;
                                    "
                                >
                                    Exit
                                </button>
                            </div>

                            <div id="focus-category-select" style="margin-bottom: 2rem">
                                <label style="font-weight: 600; display: block; margin-bottom: 1rem"
                                    >Select a category to focus on:</label
                                >
                                <div
                                    id="focus-categories"
                                    style="
                                        display: grid;
                                        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                                        gap: 0.75rem;
                                    "
                                ></div>
                            </div>

                            <div id="focus-content" style="display: none">
                                <div
                                    id="focus-header"
                                    style="
                                        display: flex;
                                        justify-content: space-between;
                                        align-items: center;
                                        margin-bottom: 1.5rem;
                                    "
                                >
                                    <h4 id="focus-title" style="margin: 0"></h4>
                                    <button
                                        onclick="showFocusCategories()"
                                        style="
                                            background: #e5e7eb;
                                            color: #374151;
                                            border: none;
                                            padding: 0.5rem 1rem;
                                            border-radius: 0.5rem;
                                            cursor: pointer;
                                        "
                                    >
                                        Change Category
                                    </button>
                                </div>
                                <div
                                    id="focus-terms"
                                    style="
                                        display: grid;
                                        grid-template-columns: repeat(
                                            auto-fill,
                                            minmax(320px, 1fr)
                                        );
                                        gap: 1rem;
                                    "
                                ></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grading Checklist Tab -->
                <div id="grading-tab" class="tab-content">
                    <div class="card">
                        <h2>Grading Checklist</h2>
                        <p>
                            Track your preparation for your next grading. Select your current belt
                            level to see everything you need to know and practice.
                        </p>

                        <div style="margin: 1.5rem 0">
                            <label style="font-weight: 600; margin-right: 1rem"
                                >I am currently:</label
                            >
                            <select
                                id="grading-current-belt"
                                onchange="updateGradingChecklist()"
                                style="
                                    padding: 0.5rem 1rem;
                                    border: 1px solid #e5e7eb;
                                    border-radius: 0.375rem;
                                    font-size: 1rem;
                                    min-width: 200px;
                                "
                            ></select>
                        </div>

                        <div
                            id="grading-target"
                            style="
                                background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
                                border: 2px solid #3b82f6;
                                border-radius: 0.75rem;
                                padding: 1.5rem;
                                margin-bottom: 2rem;
                                text-align: center;
                            "
                        >
                            <div style="font-size: 1rem; color: #1e5ba8; margin-bottom: 0.5rem">
                                Preparing for:
                            </div>
                            <div
                                id="grading-target-belt"
                                style="font-size: 1.75rem; font-weight: 700; color: #1e5ba8"
                            ></div>
                        </div>

                        <div
                            id="grading-progress-summary"
                            style="
                                background: white;
                                border: 1px solid #e5e7eb;
                                border-radius: 0.5rem;
                                padding: 1.5rem;
                                margin-bottom: 2rem;
                            "
                        >
                            <div
                                style="
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                    margin-bottom: 1rem;
                                "
                            >
                                <span style="font-weight: 600; color: #374151"
                                    >Overall Progress</span
                                >
                                <span
                                    id="grading-progress-text"
                                    style="font-weight: 600; color: #1e5ba8"
                                ></span>
                            </div>
                            <div
                                style="
                                    height: 12px;
                                    background: #e5e7eb;
                                    border-radius: 6px;
                                    overflow: hidden;
                                "
                            >
                                <div
                                    id="grading-progress-bar"
                                    style="
                                        height: 100%;
                                        background: #1e5ba8;
                                        border-radius: 6px;
                                        transition: width 0.3s;
                                    "
                                ></div>
                            </div>
                        </div>

                        <div id="grading-checklist-content"></div>

                        <div
                            style="
                                margin-top: 2rem;
                                padding: 1.5rem;
                                background: #f9fafb;
                                border-radius: 0.5rem;
                            "
                        >
                            <div style="font-weight: 600; margin-bottom: 0.5rem">
                                Tips for Grading Success:
                            </div>
                            <ul style="color: #4b5563; padding-left: 1.25rem; line-height: 1.8">
                                <li>Practice each technique until it becomes automatic</li>
                                <li>Know the Japanese names and English translations</li>
                                <li>Memorise the Dojo Kun in both languages</li>
                                <li>Practice your kata with proper timing and kiai</li>
                                <li>Stay calm and focused during the grading</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Search Tab -->
                <div id="search-tab" class="tab-content">
                    <div class="card">
                        <h2>Search</h2>
                        <p>Search across all techniques, terminology, and belt requirements.</p>

                        <div style="margin: 1.5rem 0">
                            <input
                                type="text"
                                id="search-input"
                                placeholder="Search for a technique, term, or translation..."
                                oninput="performSearch()"
                                style="
                                    width: 100%;
                                    padding: 1rem 1.25rem;
                                    font-size: 1.125rem;
                                    border: 2px solid #e5e7eb;
                                    border-radius: 0.5rem;
                                    outline: none;
                                    transition: border-color 0.2s;
                                "
                                onfocus="this.style.borderColor = '#1e5ba8'"
                                onblur="this.style.borderColor = '#e5e7eb'"
                            />
                        </div>

                        <div
                            id="search-results-count"
                            style="margin-bottom: 1rem; color: #6b7280; font-size: 1rem"
                        ></div>

                        <div id="search-results"></div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <div class="container">
                <p>
                    Content from
                    <a href="https://hakuba-karate.co.uk/" target="_blank">Hakuba Karate Dojo</a>
                </p>
                <p style="font-size: 0.875rem; color: #9ca3af; margin-top: 0.5rem">
                     2026 Matthew Hillman - Black Belt in Coding
                </p>
            </div>
        </footer>

        <script>
            // Translations for common terms
            const translations = {
                Ipponme: "First technique",
                Nihonme: "Second technique",
                Sanbonme: "Third technique",
                Yonhonme: "Fourth technique",
                Gohonme: "Fifth technique",
                Ropponme: "Sixth technique",
                Nanahonme: "Seventh technique",
                Napponme: "Eighth technique",
                "chudan soto-uke": "middle outer block",
                "chudan uchi-uke": "middle inner block",
                maegeri: "front kick",
                gyakuzuki: "reverse punch",
                empi: "elbow strike",
                "Junzuki-uke": "Defending against straight punches",
                "Maegeri-uke": "Defending against front kicks",
            };

            const beltData = {
                "9th": {
                    name: "9th Ky",
                    color: "Red Belt",
                    cssClass: "belt-red",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2018/09/9thKyu_RedBelt_Syllabus.pdf",
                    note: "Commands will be given first in Japanese then in English",
                    dojoKun: true,
                    beltTying: true,
                    kihon: {
                        blocksStance: "Junzuki-dachi",
                        otherStance: "Hanmi-gamae",
                        blocks: [
                            { name: "Jodan-uke", translation: "Head block" },
                            { name: "Chudan-soto-uke", translation: "Body outer block" },
                            { name: "Chudan-uchi-uke", translation: "Body inner block" },
                            { name: "Gedan-barai", translation: "Lower body sweeping block" },
                        ],
                        strikes: [
                            { name: "Jodan-tsuki", translation: "Head snap-punch" },
                            { name: "Uraken-uchi-jodan", translation: "Head back-fist strike" },
                        ],
                        kicks: [
                            { name: "Maegeri-chudan", translation: "Body front kick" },
                            {
                                name: "Surikomi-maegeri-chudan",
                                translation: "One step body front kick",
                            },
                            { name: "Mawashigeri-chudan", translation: "Body round-house kick" },
                            {
                                name: "Surikomi-mawashigeri-chudan",
                                translation: "One step body round-house kick",
                            },
                        ],
                    },
                },
                "8th": {
                    name: "8th Ky",
                    color: "Yellow Belt",
                    cssClass: "belt-yellow",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2018/09/8thKyu_YellowBelt_Syllabus.pdf",
                    note: "Commands will be given first in Japanese then in English",
                    dojoKun: true,
                    beltTying: true,
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Junzuki, Mawatte-jodan-uke",
                                translation: "Straight punch, turn with head block",
                            },
                            {
                                name: "Gyakuzuki, Mawatte-gedan-barai",
                                translation: "Reverse punch, turn with lower body sweeping block",
                            },
                            { name: "Maegeri-chudan", translation: "Front kick to the body" },
                            {
                                name: "Surikomi-maegeri-chudan",
                                translation: "One step front kick to the body",
                            },
                            {
                                name: "Sokuto-fumikomi-hiza",
                                translation: "Side edge stamping kick to the knee",
                            },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Maegeri-chudan-tobikomizuki-jodan",
                                translation: "Front kick to the body, snap punch to the head",
                            },
                            {
                                name: "Surikomi-maegeri-chudan-tobikomizuki-jodan",
                                translation:
                                    "One step front kick to the body, snap punch to the head",
                            },
                            {
                                name: "Maegeri-chudan-gyakuzuki-chudan",
                                translation: "Front kick, reverse punch to the body",
                            },
                            {
                                name: "Surikomi-maegeri-chudan-gyakuzuki-chudan",
                                translation: "One step front kick, reverse punch to the body",
                            },
                        ],
                    },
                    uke: {
                        title: "Uke (Blocking techniques)",
                        stance: "Junzuki-dachi",
                        list: [
                            {
                                name: "Chudan-soto-uke-gyakuzuki",
                                translation: "Body outer block, reverse punch",
                            },
                            {
                                name: "Chudan-uchi-uke-gyakuzuki",
                                translation: "Body inner block, reverse punch",
                            },
                        ],
                        note: "All blocks performed with turning block (outer/inner), reverse punch",
                    },
                },
                "7th": {
                    name: "7th Ky",
                    color: "Orange Belt",
                    cssClass: "belt-orange",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2018/09/7thKyu_OrangeBelt_Syllabus.pdf",
                    note: "From this belt onwards, all commands are in Japanese only",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Junzuki-no-tsukkomi", translation: "Leaning lunge punch" },
                            { name: "Gyakuzuki-no-tsukkomi", translation: "Leaning reverse punch" },
                            { name: "Mawashigeri-chudan", translation: "Body roundhouse kick" },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Maegeri-chudan  Mawashigeri-chudan  Gyakuzuki-chudan",
                                translation:
                                    "Front kick  Roundhouse kick  Reverse punch (all to body)",
                            },
                            {
                                name: "Surikomi-maegeri-chudan  Mawashigeri-chudan  Gyakuzuki-chudan",
                                translation:
                                    "One step front kick  Roundhouse kick  Reverse punch (all to body)",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            {
                                name: "Junzuki-uke",
                                translation: "Defending against straight punches",
                            },
                            {
                                name: "Gohonme",
                                translation:
                                    "5th technique: middle outer block - front kick - reverse punch",
                                detail: "(chudan soto-uke - maegeri - gyakuzuki)",
                            },
                            {
                                name: "Ropponme",
                                translation: "6th technique: middle inner block - elbow strike",
                                detail: "(chudan uchi-uke - empi)",
                            },
                        ],
                    },
                    kata: {
                        name: "Pinan Nidan",
                        link: "https://youtu.be/SM1OS-k4BCE",
                    },
                },
                "6th": {
                    name: "6th Ky",
                    color: "Green Belt",
                    cssClass: "belt-green",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2018/09/6thKyu_GreenBelt_Syllabus.pdf",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            { name: "Tobikomizuki-jodan", translation: "Snap punch to the head" },
                            {
                                name: "Surikomi-mawashigeri-chudan",
                                translation: "One step roundhouse kick to the body",
                            },
                            {
                                name: "Surikomi-sokuto-chudan",
                                translation: "One step side edge kick to the body",
                            },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Maegeri-chudan  Sokuto-fumikomi-hiza  Gyakuzuki-chudan",
                                translation:
                                    "Front kick body  Side edge stamp knee  Reverse punch body",
                            },
                            {
                                name: "Surikomi-maegeri-chudan  Sokuto-chudan  Gyakuzuki-chudan",
                                translation:
                                    "One step front kick  Side edge body  Reverse punch body",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            {
                                name: "Junzuki-uke: Ipponme, Nihonme",
                                translation:
                                    "Defending against straight punches: 1st & 2nd techniques",
                            },
                            {
                                name: "Maegeri-uke: Ipponme, Nihonme",
                                translation: "Defending against front kicks: 1st & 2nd techniques",
                            },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [{ name: "Ipponme", translation: "First technique" }],
                    },
                    kata: {
                        name: "Pinan Shodan, Pinan Sandan",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                },
                "5th": {
                    name: "5th Ky",
                    color: "Blue Belt",
                    cssClass: "belt-blue",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2018/09/5thKyu_BlueBelt_Syllabus.pdf",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            {
                                name: "Kette-junzuki-no-tsukkomi",
                                translation: "Stepping leaning lunge punch",
                            },
                            {
                                name: "Kette-gyakuzuki-no-tsukkomi",
                                translation: "Stepping leaning reverse punch",
                            },
                            {
                                name: "Nagashizuki-jodan",
                                translation: "Deflecting punch to the head",
                            },
                            { name: "Ushirogeri-gedan", translation: "Back kick low" },
                            { name: "Sokuto-chudan", translation: "Side edge kick body" },
                            { name: "Nidangeri-jodan", translation: "Double level kick head" },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Mawashigeri-chudan  Ushirogeri-gedan  Gyakuzuki-chudan",
                                translation: "Roundhouse body  Back kick low  Reverse punch body",
                            },
                            {
                                name: "Surikomi-sokuto-fumikomi-hiza  Ushirogeri-gedan  Uraken-uchi-jodan",
                                translation:
                                    "One step side stamp knee  Back kick low  Back fist head",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            {
                                name: "Junzuki-uke: Sanbonme, Yonhonme",
                                translation:
                                    "Defending against straight punches: 3rd & 4th techniques",
                            },
                            {
                                name: "Maegeri-uke: Sanbonme, Yonhonme",
                                translation: "Defending against front kicks: 3rd & 4th techniques",
                            },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [{ name: "Nihonme", translation: "Second technique" }],
                    },
                    kata: {
                        name: "Pinan Sandan, Pinan Yodan",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                },
                "4th": {
                    name: "4th Ky",
                    color: "Purple Belt",
                    cssClass: "belt-purple",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2018/09/4thKyu_PurpleBelt_Syllabus.pdf",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            {
                                name: "Kette-junzuki-no-tsukkomi",
                                translation: "Stepping leaning lunge punch",
                            },
                            {
                                name: "Kette-gyakuzuki-no-tsukkomi",
                                translation: "Stepping leaning reverse punch",
                            },
                            {
                                name: "Nagashizuki-jodan",
                                translation: "Deflecting punch to the head",
                            },
                            { name: "Mawashigeri-chudan", translation: "Roundhouse kick body" },
                            { name: "Ushirogeri-chudan", translation: "Back kick body" },
                            { name: "Sokuto-chudan", translation: "Side edge kick body" },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Maegeri-chudan  Nagashizuki-jodan  Gyakuzuki-chudan",
                                translation:
                                    "Front kick body  Deflecting punch head  Reverse punch body",
                            },
                            {
                                name: "Surikomi-maegeri-chudan  Nagashizuki-jodan  Mawashigeri-chudan",
                                translation:
                                    "One step front kick  Deflecting punch head  Roundhouse kick body",
                            },
                            {
                                name: "Maegeri-chudan  Sokuto-fumikomi-hiza  Ushirogeri-gedan  Gyakuzuki-chudan",
                                translation:
                                    "Front kick  Side stamp knee  Back kick low  Reverse punch body",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            {
                                name: "Junzuki-uke: Gohonme, Ropponme",
                                translation:
                                    "Defending against straight punches: 5th & 6th techniques",
                            },
                            {
                                name: "Maegeri-uke: Gohonme, Ropponme",
                                translation: "Defending against front kicks: 5th & 6th techniques",
                            },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [{ name: "Sanbonme", translation: "Third technique" }],
                    },
                    kata: {
                        name: "Pinan Yodan, Pinan Godan",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                },
                "3rd": {
                    name: "3rd Ky",
                    color: "Brown Belt",
                    cssClass: "belt-brown",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2023/03/3rdKyu_BrownBelt_Syllabus.pdf",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            {
                                name: "Kette-junzuki-no-tsukkomi",
                                translation: "Stepping leaning lunge punch",
                            },
                            {
                                name: "Kette-gyakuzuki-no-tsukkomi",
                                translation: "Stepping leaning reverse punch",
                            },
                            { name: "Tobikomizuki-jodan", translation: "Snap punch to the head" },
                            {
                                name: "Nagashizuki-jodan",
                                translation: "Deflecting punch to the head",
                            },
                            { name: "Mawashigeri-jodan", translation: "Roundhouse kick head" },
                            { name: "Ushirogeri-chudan", translation: "Back kick body" },
                            {
                                name: "Surikomi-sokuto-jodan",
                                translation: "One step side edge kick head",
                            },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Surikomi-maegeri-chudan  Mawashigeri-chudan  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "One step front kick  Roundhouse body  Back kick body  Back fist head",
                            },
                            {
                                name: "Maegeri-chudan - Nagashizuki-jodan  Gyakuzuki-chudan  Mawashigeri-chudan",
                                translation:
                                    "Front kick  Deflecting punch head  Reverse punch body  Roundhouse kick body",
                            },
                            {
                                name: "Surikomi-maegeri-chudan  Sokuto-fumikomi-hiza  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "One step front kick  Side stamp knee  Back kick body  Back fist head",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            {
                                name: "Junzuki-uke: Ipponme, Nihonme",
                                translation:
                                    "Defending against straight punches: 1st & 2nd techniques",
                            },
                            {
                                name: "Maegeri-uke: Ipponme, Nihonme",
                                translation: "Defending against front kicks: 1st & 2nd techniques",
                            },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [{ name: "Yonhonme", translation: "Fourth technique" }],
                    },
                    kihonGumite: {
                        title: "Kihon-Gumite (Basic sparring)",
                        items: [{ name: "Ipponme, Nihonme", translation: "1st & 2nd techniques" }],
                    },
                    machiOhyo: {
                        title: "Machi-Ohyo (Street application)",
                        items: [{ name: "Ipponme, Nihonme", translation: "1st & 2nd techniques" }],
                    },
                    kata: {
                        name: "Ku-Shanku (Kushanku)",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                },
                "2nd": {
                    name: "2nd Ky",
                    color: "Brown Belt (White Stripe)",
                    cssClass: "belt-brown-white",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2023/03/2ndKyu_BrownWhiteBelt_Syllabus.pdf",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            {
                                name: "Kette-junzuki-no-tsukkomi",
                                translation: "Stepping leaning lunge punch",
                            },
                            {
                                name: "Kette-gyakuzuki-no-tsukkomi",
                                translation: "Stepping leaning reverse punch",
                            },
                            {
                                name: "Nagashizuki-jodan",
                                translation: "Deflecting punch to the head",
                            },
                            { name: "Mawashigeri-jodan", translation: "Roundhouse kick head" },
                            { name: "Sokuto-jodan", translation: "Side edge kick head" },
                            { name: "Ushirogeri-chudan", translation: "Back kick body" },
                            { name: "Nidangeri-jodan", translation: "Double level kick head" },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Surikomi-maegeri-chudan  Nagashizuki-jodan  Mawashigeri-jodan",
                                translation:
                                    "One step front kick  Deflecting punch head  Roundhouse kick head",
                            },
                            {
                                name: "Maegeri-chudan  Sokuto-chudan  Ushirogeri-chudan  Gyakuzuki-chudan",
                                translation:
                                    "Front kick body  Side edge body  Back kick body  Reverse punch body",
                            },
                            {
                                name: "Zenshinshite-jodan - Renzuki-chudan - Surikomi-maegeri-chudan - Mawashigeri-chudan - Gyakuzuki-chudan",
                                translation:
                                    "Step forward head  Follow punch body  One step front kick  Roundhouse body  Reverse punch body",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            {
                                name: "Junzuki-uke: Sanbonme, Yonhonme",
                                translation:
                                    "Defending against straight punches: 3rd & 4th techniques",
                            },
                            {
                                name: "Maegeri-uke: Sanbonme, Yonhonme",
                                translation: "Defending against front kicks: 3rd & 4th techniques",
                            },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [{ name: "Gohonme, Ropponme", translation: "5th & 6th techniques" }],
                    },
                    kihonGumite: {
                        title: "Kihon-Gumite (Basic sparring)",
                        items: [
                            { name: "Sanbonme, Yonhonme", translation: "3rd & 4th techniques" },
                        ],
                    },
                    machiOhyo: {
                        title: "Machi-Ohyo (Street application)",
                        items: [
                            {
                                name: "Ipponme, Nihonme, Sanbonme, Yonhonme",
                                translation: "1st, 2nd, 3rd & 4th techniques",
                            },
                        ],
                    },
                    kata: {
                        name: "Ku-Shanku, Nai-hanchi",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                },
                "1st": {
                    name: "1st Ky",
                    color: "Brown Belt (Black Stripe)",
                    cssClass: "belt-brown-black",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2023/03/1stKyu_BrownBlackBeltSyllabus.pdf",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            {
                                name: "Kette-junzuki-no-tsukkomi",
                                translation: "Stepping leaning lunge punch",
                            },
                            {
                                name: "Kette-gyakuzuki-no-tsukkomi",
                                translation: "Stepping leaning reverse punch",
                            },
                            {
                                name: "Nagashizuki-jodan",
                                translation: "Deflecting punch to the head",
                            },
                            {
                                name: "Surikomi-mawashigeri-jodan",
                                translation: "One step roundhouse kick head",
                            },
                            {
                                name: "Surikomi-sokuto-jodan",
                                translation: "One step side edge kick head",
                            },
                            { name: "Ushirogeri-chudan", translation: "Back kick body" },
                            { name: "Nidangeri-jodan", translation: "Double level kick head" },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Zenshinshite-jodan  Renzuki-chudan  Maegeri-chudan  Mawashigeri-chudan  Ushirogeri-chudan  Gyakuzuki-chudan",
                                translation:
                                    "Step forward head  Follow punch body  Front kick body  Roundhouse body  Back kick body  Reverse punch body",
                            },
                            {
                                name: "Surikomi-jodan  Renzuki-chudan  Surikomi-maegeri-chudan  Mawashigeri-chudan  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "One step head  Follow punch body  One step front kick  Roundhouse body  Back kick body  Back fist head",
                            },
                            {
                                name: "Zenshinshite-jodan  Renzuki-chudan  Maegeri-chudan  Nagashizuki-jodan  Gyakuzuki-chudan  Mawashigeri-jodan",
                                translation:
                                    "Step forward head  Follow punch body  Front kick body  Deflecting punch head  Reverse punch body  Roundhouse head",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            {
                                name: "Junzuki-uke: Gohonme, Ropponme",
                                translation:
                                    "Defending against straight punches: 5th & 6th techniques",
                            },
                            {
                                name: "Maegeri-uke: Gohonme, Ropponme",
                                translation: "Defending against front kicks: 5th & 6th techniques",
                            },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [
                            { name: "Nanahonme, Napponme", translation: "7th & 8th techniques" },
                        ],
                    },
                    kihonGumite: {
                        title: "Kihon-Gumite (Basic sparring)",
                        items: [{ name: "Gohonme", translation: "5th technique" }],
                    },
                    machiOhyo: {
                        title: "Machi-Ohyo (Street application)",
                        items: [
                            {
                                name: "Ipponme, Nihonme, Sanbonme, Yonhonme, Gohonme, Ropponme",
                                translation: "1st, 2nd, 3rd, 4th, 5th & 6th techniques",
                            },
                        ],
                    },
                    kata: {
                        name: "Ku-Shanku, Seishan, Chinto",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                },
                Shodan: {
                    name: "Shodan (1st Dan)",
                    color: "Black Belt",
                    cssClass: "belt-black-1dan",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2023/03/SHODAN-.pdf",
                    note: "First degree black belt - demonstrates mastery of fundamental techniques",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            {
                                name: "Kette-junzuki-no-tsukkomi",
                                translation: "Stepping leaning lunge punch",
                            },
                            {
                                name: "Kette-gyakuzuki-no-tsukkomi",
                                translation: "Stepping leaning reverse punch",
                            },
                            { name: "Tobikomizuki-jodan", translation: "Snap punch to the head" },
                            {
                                name: "Nagashizuki-jodan",
                                translation: "Deflecting punch to the head",
                            },
                            { name: "Mawashigeri-jodan", translation: "Roundhouse kick head" },
                            { name: "Sokuto-jodan", translation: "Side edge kick head" },
                            { name: "Ushirogeri-chudan", translation: "Back kick body" },
                            { name: "Nidangeri-jodan", translation: "Double level kick head" },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Zenshinshite-jodan  Renzuki-chudan  Maegeri-chudan  Mawashigeri-jodan  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "Step forward head  Follow punch body  Front kick body  Roundhouse head  Back kick body  Back fist head",
                            },
                            {
                                name: "Surikomi-jodan  Renzuki-chudan  Surikomi-sokuto-jodan  Ushirogeri-chudan  Gyakuzuki-chudan",
                                translation:
                                    "One step head  Follow punch body  One step side edge head  Back kick body  Reverse punch body",
                            },
                            {
                                name: "Zenshinshite-jodan  Renzuki-chudan  Maegeri-chudan  Nagashizuki-jodan  Gyakuzuki-chudan  Mawashigeri-jodan  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "Step forward head  Follow punch body  Front kick body  Deflecting punch head  Reverse punch body  Roundhouse head  Back kick body  Back fist head",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            { name: "All techniques", translation: "All Sanbon-Gumite sequences" },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [
                            {
                                name: "Ipponme, Nihonme, Sanbonme, Yonhonme",
                                translation: "1st, 2nd, 3rd & 4th techniques",
                            },
                        ],
                    },
                    kihonGumite: {
                        title: "Kihon-Gumite (Basic sparring)",
                        items: [
                            {
                                name: "Ipponme, Nihonme, Sanbonme, Yonhonme",
                                translation: "1st, 2nd, 3rd & 4th techniques",
                            },
                        ],
                    },
                    machiOhyo: {
                        title: "Machi-Ohyo (Street application)",
                        items: [
                            {
                                name: "Ipponme - Happonme",
                                translation: "1st through 8th techniques",
                            },
                        ],
                    },
                    kata: {
                        name: "Three Kata from first nine (examiner's choice) + Bassai, Wanshu",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                    additional: {
                        jiyuGumite: "Free fighting",
                        hikkiShiken: "Written test required",
                    },
                },
                Nidan: {
                    name: "Nidan (2nd Dan)",
                    color: "Black Belt",
                    cssClass: "belt-black-2dan",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2023/03/NIDAN-.pdf",
                    note: "Second degree black belt - advanced technical proficiency",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            {
                                name: "Kette-junzuki-no-tsukkomi",
                                translation: "Stepping leaning lunge punch",
                            },
                            {
                                name: "Kette-gyakuzuki-no-tsukkomi",
                                translation: "Stepping leaning reverse punch",
                            },
                            { name: "Tobikomizuki-jodan", translation: "Snap punch to the head" },
                            {
                                name: "Nagashizuki-jodan",
                                translation: "Deflecting punch to the head",
                            },
                            { name: "Mawashigeri-jodan", translation: "Roundhouse kick head" },
                            { name: "Sokuto-jodan", translation: "Side edge kick head" },
                            { name: "Ushirogeri-chudan", translation: "Back kick body" },
                            { name: "Nidangeri-jodan", translation: "Double level kick head" },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Zenshinshite-jodan  Renzuki-chudan  Maegeri-chudan  Mawashigeri-jodan  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "Step forward head  Follow punch body  Front kick body  Roundhouse head  Back kick body  Back fist head",
                            },
                            {
                                name: "Surikomi-jodan  Renzuki-chudan  Surikomi-sokuto-jodan  Ushirogeri-chudan  Gyakuzuki-chudan",
                                translation:
                                    "One step head  Follow punch body  One step side edge head  Back kick body  Reverse punch body",
                            },
                            {
                                name: "Zenshinshite-jodan  Renzuki-chudan  Maegeri-chudan  Nagashizuki-jodan  Gyakuzuki-chudan  Mawashigeri-jodan  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "Step forward head  Follow punch body  Front kick body  Deflecting punch head  Reverse punch body  Roundhouse head  Back kick body  Back fist head",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            { name: "All techniques", translation: "All Sanbon-Gumite sequences" },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [
                            {
                                name: "Gohonme, Ropponme, Nanahonme, Napponme",
                                translation: "5th, 6th, 7th & 8th techniques",
                            },
                        ],
                    },
                    kihonGumite: {
                        title: "Kihon-Gumite (Basic sparring)",
                        items: [
                            {
                                name: "Gohonme, Ropponme, Nanahonme, Napponme",
                                translation: "5th, 6th, 7th & 8th techniques",
                            },
                        ],
                    },
                    machiOhyo: {
                        title: "Machi-Ohyo (Street application)",
                        items: [
                            {
                                name: "Ipponme - Happonme",
                                translation: "1st through 8th techniques",
                            },
                        ],
                    },
                    kata: {
                        name: "Three Kata from first nine (examiner's choice) + Ni-sei-shi, Rohai",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                    additional: {
                        jiyuGumite: "Free fighting",
                        hikkiShiken: "Written test required",
                    },
                },
                Sandan: {
                    name: "Sandan (3rd Dan)",
                    color: "Black Belt",
                    cssClass: "belt-black-3dan",
                    pdf: "https://hakuba-karate.co.uk/wp-content/uploads/2023/03/SANDAN-.pdf",
                    note: "Third degree black belt - expert level mastery",
                    kihon: {
                        stance: "Hanmi-gamae",
                        list: [
                            { name: "Kette-junzuki", translation: "Stepping forward punch" },
                            { name: "Kette-gyakuzuki", translation: "Stepping reverse punch" },
                            {
                                name: "Kette-junzuki-no-tsukkomi",
                                translation: "Stepping leaning lunge punch",
                            },
                            {
                                name: "Kette-gyakuzuki-no-tsukkomi",
                                translation: "Stepping leaning reverse punch",
                            },
                            { name: "Tobikomizuki-jodan", translation: "Snap punch to the head" },
                            {
                                name: "Nagashizuki-jodan",
                                translation: "Deflecting punch to the head",
                            },
                            { name: "Mawashigeri-jodan", translation: "Roundhouse kick head" },
                            { name: "Sokuto-jodan", translation: "Side edge kick head" },
                            { name: "Ushirogeri-chudan", translation: "Back kick body" },
                            { name: "Nidangeri-jodan", translation: "Double level kick head" },
                        ],
                    },
                    renraku: {
                        title: "Renraku-Waza (Combination techniques)",
                        stance: "Hanmi-gamae",
                        list: [
                            {
                                name: "Zenshinshite-jodan  Renzuki-chudan  Maegeri-chudan  Mawashigeri-jodan  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "Step forward head  Follow punch body  Front kick body  Roundhouse head  Back kick body  Back fist head",
                            },
                            {
                                name: "Surikomi-jodan  Renzuki-chudan  Surikomi-sokuto-jodan  Ushirogeri-chudan  Gyakuzuki-chudan",
                                translation:
                                    "One step head  Follow punch body  One step side edge head  Back kick body  Reverse punch body",
                            },
                            {
                                name: "Zenshinshite-jodan  Renzuki-chudan  Maegeri-chudan  Nagashizuki-jodan  Gyakuzuki-chudan  Mawashigeri-jodan  Ushirogeri-chudan  Uraken-uchi-jodan",
                                translation:
                                    "Step forward head  Follow punch body  Front kick body  Deflecting punch head  Reverse punch body  Roundhouse head  Back kick body  Back fist head",
                            },
                        ],
                    },
                    sanbon: {
                        title: "Sanbon-Gumite (Three-step sparring)",
                        items: [
                            { name: "All techniques", translation: "All Sanbon-Gumite sequences" },
                        ],
                    },
                    ohyo: {
                        title: "Ohyo-Gumite (Application sparring)",
                        items: [
                            { name: "All techniques", translation: "All Ohyo-Gumite sequences" },
                        ],
                    },
                    kihonGumite: {
                        title: "Kihon-Gumite (Basic sparring)",
                        items: [
                            { name: "All techniques", translation: "All Kihon-Gumite sequences" },
                        ],
                    },
                    machiOhyo: {
                        title: "Machi-Ohyo (Street application)",
                        items: [
                            {
                                name: "All 1-8 plus one additional",
                                translation: "All eight techniques plus one additional technique",
                            },
                        ],
                    },
                    kata: {
                        name: "Three Kata from first nine (examiner's choice) + Ji'tte, Ji'han, Ji'in",
                        link: "https://hakuba-karate.co.uk/katas-of-wadoryu/",
                    },
                    additional: {
                        jiyuGumite: "Free fighting",
                        hikkiShiken: "Written test required",
                    },
                },
            };

            let currentBelt = "9th";
            let learnedTechniques = {};

            function initBeltSelector() {
                const selector = document.getElementById("belt-selector");
                const savedBelt = localStorage.getItem("selectedBelt") || "9th";

                Object.keys(beltData).forEach((key) => {
                    const belt = beltData[key];
                    const button = document.createElement("button");
                    button.className = "belt-button " + belt.cssClass;
                    button.innerHTML =
                        '<div class="belt-name">' +
                        belt.name +
                        '</div><div class="belt-color">' +
                        belt.color +
                        "</div>";
                    button.onclick = () => selectBelt(key);
                    if (key === savedBelt) button.classList.add("active");
                    selector.appendChild(button);
                });

                currentBelt = savedBelt;
                displayBelt(savedBelt);
            }

            function selectBelt(key) {
                currentBelt = key;
                localStorage.setItem("selectedBelt", key);
                document
                    .querySelectorAll(".belt-button")
                    .forEach((btn) => btn.classList.remove("active"));
                event.target.closest(".belt-button").classList.add("active");
                displayBelt(key);
                // Scroll to the belt content
                document
                    .getElementById("belt-content")
                    .scrollIntoView({ behavior: "smooth", block: "start" });
            }

            function getTechniqueCardHtml(key, tech, stanceInfo) {
                const techId = key + "-" + tech.name;
                const learned = isLearned(techId);
                const cardClass = learned ? "technique-card learned" : "technique-card";
                const btnClass = learned ? "learn-btn learned" : "learn-btn";
                const btnText = learned ? " Learned" : "Mark as learned";

                let html = '<div class="' + cardClass + '">';
                html += '<div class="japanese">' + tech.name + "</div>";
                html += '<div class="english">' + tech.translation + "</div>";
                if (stanceInfo) {
                    html +=
                        '<div class="stance-info">From: <a href="#" onclick="switchToStances(); return false;">' +
                        stanceInfo +
                        "</a></div>";
                }
                html +=
                    '<button class="' +
                    btnClass +
                    '" onclick="toggleLearned(\'' +
                    techId.replace(/'/g, "\\'") +
                    "')\">" +
                    btnText +
                    "</button>";
                html += "</div>";
                return html;
            }

            function displayBelt(key) {
                const belt = beltData[key];
                const content = document.getElementById("belt-content");
                const progress = getBeltProgress(key);

                // Get belt color for progress bar
                const beltColors = {
                    "9th": "#dc2626", // Red
                    "8th": "#fbbf24", // Yellow
                    "7th": "#f97316", // Orange
                    "6th": "#059669", // Green
                    "5th": "#2563eb", // Blue
                    "4th": "#7c3aed", // Purple
                    "3rd": "#92400e", // Brown
                    "2nd": "#92400e", // Brown
                    "1st": "#92400e", // Brown
                    Shodan: "#000", // Black
                    Nidan: "#000", // Black
                    Sandan: "#000", // Black
                };
                const beltColor = beltColors[key] || "#1e5ba8";

                let html = '<div class="card">';

                // Progress summary with belt color
                if (progress.total > 0) {
                    html +=
                        '<div class="progress-summary" style="flex-direction: column; gap: 0.75rem;">';
                    html +=
                        '<div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">';
                    html +=
                        '<div class="progress-text" style="font-weight: 700; color: ' +
                        beltColor +
                        ';">' +
                        belt.color +
                        " Progress</div>";
                    html +=
                        '<div class="progress-text">' +
                        progress.learned +
                        " / " +
                        progress.total +
                        " techniques (" +
                        progress.percentage +
                        "%)</div>";
                    html += "</div>";
                    html +=
                        '<div class="progress-bar-large" style="width: 100%;"><div class="progress-bar-large-fill" style="width: ' +
                        progress.percentage +
                        "%; background: " +
                        beltColor +
                        ';"></div></div>';
                    html += "</div>";
                }

                html +=
                    '<div class="belt-indicator ' +
                    belt.cssClass +
                    '">' +
                    belt.name +
                    " - " +
                    belt.color +
                    "</div>";
                html += "<h2>Syllabus Requirements</h2>";

                if (belt.note) {
                    html += '<div class="note-box"><strong>Note:</strong> ' + belt.note + "</div>";
                }

                if (belt.dojoKun) {
                    html +=
                        '<div class="info-box"><strong>Required:</strong> You will be tested on the Dojo Kun (recited in Japanese and English) at this grading.</div>';
                }

                if (belt.beltTying) {
                    html +=
                        '<div class="info-box"><strong>Required:</strong> You will be tested on correct traditional Wado-ryu belt-tying technique (Hon-Musubi ). See the Belt Tying tab for detailed instructions.</div>';
                }

                if (belt.kihon) {
                    html += "<h3>Kihon-Waza (Fundamental Techniques)</h3>";

                    if (belt.kihon.blocks) {
                        html += "<h4>Blocks</h4>";
                        html += '<div class="technique-grid">';
                        belt.kihon.blocks.forEach((tech) => {
                            html += getTechniqueCardHtml(
                                key,
                                tech,
                                belt.kihon.blocksStance + " (forward stance)",
                            );
                        });
                        html += "</div>";
                    }

                    if (belt.kihon.strikes) {
                        html += "<h4>Strikes</h4>";
                        html += '<div class="technique-grid">';
                        belt.kihon.strikes.forEach((tech) => {
                            html += getTechniqueCardHtml(
                                key,
                                tech,
                                belt.kihon.otherStance + " (fighting stance)",
                            );
                        });
                        html += "</div>";
                    }

                    if (belt.kihon.kicks) {
                        html += "<h4>Kicks</h4>";
                        html += '<div class="technique-grid">';
                        belt.kihon.kicks.forEach((tech) => {
                            html += getTechniqueCardHtml(
                                key,
                                tech,
                                belt.kihon.otherStance + " (fighting stance)",
                            );
                        });
                        html += "</div>";
                    }

                    if (belt.kihon.list) {
                        html += '<div class="technique-grid">';
                        belt.kihon.list.forEach((tech) => {
                            const stanceInfo = belt.kihon.stance
                                ? belt.kihon.stance + " (fighting stance)"
                                : null;
                            html += getTechniqueCardHtml(key, tech, stanceInfo);
                        });
                        html += "</div>";
                    }
                }

                if (belt.renraku) {
                    html += "<h3>" + belt.renraku.title + "</h3>";
                    html += '<div class="technique-grid">';
                    belt.renraku.list.forEach((tech) => {
                        const stanceInfo = belt.renraku.stance
                            ? belt.renraku.stance + " (fighting stance)"
                            : null;
                        html += getTechniqueCardHtml(key, tech, stanceInfo);
                    });
                    html += "</div>";
                }

                if (belt.uke) {
                    html += "<h3>" + belt.uke.title + "</h3>";
                    if (belt.uke.note) {
                        html +=
                            '<p style="font-style:italic;color:#6b7280;">' + belt.uke.note + "</p>";
                    }
                    html += '<div class="technique-grid">';
                    belt.uke.list.forEach((tech) => {
                        const stanceInfo = belt.uke.stance
                            ? belt.uke.stance + " (forward stance)"
                            : null;
                        html += getTechniqueCardHtml(key, tech, stanceInfo);
                    });
                    html += "</div>";
                }

                if (belt.sanbon) {
                    html += "<h3>" + belt.sanbon.title + "</h3>";
                    html += '<div class="sparring-section"><ul>';
                    belt.sanbon.items.forEach((item) => {
                        html +=
                            '<li><span class="technique-name">' +
                            item.name +
                            "</span>: " +
                            item.translation;
                        if (item.detail) html += " " + item.detail;
                        html += "</li>";
                    });
                    html += "</ul></div>";
                }

                if (belt.ohyo) {
                    html += "<h3>" + belt.ohyo.title + "</h3>";
                    html += '<div class="sparring-section"><ul>';
                    belt.ohyo.items.forEach((item) => {
                        html +=
                            '<li><span class="technique-name">' +
                            item.name +
                            "</span>: " +
                            item.translation +
                            "</li>";
                    });
                    html += "</ul></div>";
                }

                if (belt.kihonGumite) {
                    html += "<h3>" + belt.kihonGumite.title + "</h3>";
                    html += '<div class="sparring-section"><ul>';
                    belt.kihonGumite.items.forEach((item) => {
                        html +=
                            '<li><span class="technique-name">' +
                            item.name +
                            "</span>: " +
                            item.translation +
                            "</li>";
                    });
                    html += "</ul></div>";
                }

                if (belt.machiOhyo) {
                    html += "<h3>" + belt.machiOhyo.title + "</h3>";
                    html += '<div class="sparring-section"><ul>';
                    belt.machiOhyo.items.forEach((item) => {
                        html +=
                            '<li><span class="technique-name">' +
                            item.name +
                            "</span>: " +
                            item.translation +
                            "</li>";
                    });
                    html += "</ul></div>";
                }

                if (belt.kata) {
                    html += "<h3>Kata</h3>";
                    html +=
                        '<div class="info-box"><strong>Required Kata:</strong> ' +
                        belt.kata.name +
                        "</div>";

                    // Add kata videos if available
                    const kataVideos = {
                        "Pinan Nidan": "https://www.youtube.com/embed/SM1OS-k4BCE?feature=oembed",
                        "Pinan Shodan": "https://www.youtube.com/embed/3HOPMLxlHO8?feature=oembed",
                        "Pinan Sandan": "https://www.youtube.com/embed/_PNcWV9FAp8?feature=oembed",
                        "Pinan Yodan": "https://www.youtube.com/embed/mUQFUOpp-9E?feature=oembed",
                        "Pinan Godan": "https://www.youtube.com/embed/hWV56JLPC5A?feature=oembed",
                        "Ku-Shanku": "https://www.youtube.com/embed/4iJJNeVXbI8?feature=oembed",
                        "Nai-hanchi": "https://www.youtube.com/embed/_q9mPQUwx7Y?feature=oembed",
                        Seishan: "https://www.youtube.com/embed/hntFG9WTQJE?feature=oembed",
                        Chinto: "https://www.youtube.com/embed/Gv9uPfz1tkM?feature=oembed",
                        Bassai: "https://www.youtube.com/embed/GMJyFrf4BtA?feature=oembed",
                        Wanshu: "https://www.youtube.com/embed/0Ck8rk5xDwI?feature=oembed",
                    };

                    // Find matching videos for this belt's kata
                    const kataNames = belt.kata.name.split(",").map((k) => k.trim());
                    let hasVideos = false;
                    let videoHtml =
                        '<div class="kata-videos" style="margin-top: 1.5rem;"><h4 style="margin-bottom: 1rem;">Kata Videos</h4><div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">';

                    kataNames.forEach((kataName) => {
                        // Check each known kata name
                        Object.keys(kataVideos).forEach((key) => {
                            if (kataName.includes(key)) {
                                hasVideos = true;
                                videoHtml +=
                                    '<div style="background: white; border: 1px solid #e5e7eb; border-radius: 0.5rem; overflow: hidden;">';
                                videoHtml +=
                                    '<div style="position: relative; padding-bottom: 56.25%; height: 0;">';
                                videoHtml +=
                                    '<iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="' +
                                    kataVideos[key] +
                                    '" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>';
                                videoHtml += "</div>";
                                videoHtml +=
                                    '<div style="padding: 0.75rem; font-weight: 600; color: #374151;">' +
                                    key +
                                    "</div>";
                                videoHtml += "</div>";
                            }
                        });
                    });

                    videoHtml += "</div></div>";
                    if (hasVideos) {
                        html += videoHtml;
                    }
                }

                if (belt.additional) {
                    html += "<h3>Additional Requirements</h3>";
                    html += '<div class="sparring-section"><ul>';
                    if (belt.additional.jiyuGumite) {
                        html +=
                            '<li><span class="technique-name">Jiyu-Gumite ()</span>: ' +
                            belt.additional.jiyuGumite +
                            "</li>";
                    }
                    if (belt.additional.hikkiShiken) {
                        html +=
                            '<li><span class="technique-name">Hikki-Shiken ()</span>: ' +
                            belt.additional.hikkiShiken +
                            "</li>";
                    }
                    html += "</ul></div>";
                }

                html +=
                    '<a href="' +
                    belt.pdf +
                    '" target="_blank" class="btn-primary">Download Full Syllabus PDF </a>';
                html += "</div>";

                content.innerHTML = html;
            }

            function goHome() {
                document
                    .querySelectorAll(".nav-button")
                    .forEach((b) => b.classList.remove("active"));
                document
                    .querySelectorAll(".tab-content")
                    .forEach((t) => t.classList.remove("active"));

                document.querySelector('[data-tab="belts"]').classList.add("active");
                document.getElementById("belts-tab").classList.add("active");
                window.scrollTo(0, 0);
            }

            function switchToStances() {
                document
                    .querySelectorAll(".nav-button")
                    .forEach((b) => b.classList.remove("active"));
                document
                    .querySelectorAll(".tab-content")
                    .forEach((t) => t.classList.remove("active"));

                document.querySelector('[data-tab="stances"]').classList.add("active");
                document.getElementById("stances-tab").classList.add("active");
                window.scrollTo(0, 0);
            }

            function initTabs() {
                document.querySelectorAll(".nav-button").forEach((button) => {
                    button.addEventListener("click", function () {
                        const tabName = this.getAttribute("data-tab");

                        document
                            .querySelectorAll(".nav-button")
                            .forEach((b) => b.classList.remove("active"));
                        document
                            .querySelectorAll(".tab-content")
                            .forEach((t) => t.classList.remove("active"));

                        this.classList.add("active");
                        document.getElementById(tabName + "-tab").classList.add("active");

                        // Close mobile menu when tab is clicked
                        closeMobileMenu();
                    });
                });
            }

            // Mobile menu functions
            function toggleMobileMenu() {
                const hamburger = document.getElementById("hamburger");
                const navContainer = document.getElementById("nav-container");
                const navOverlay = document.getElementById("nav-overlay");

                hamburger.classList.toggle("active");
                navContainer.classList.toggle("active");
                navOverlay.classList.toggle("active");

                // Prevent body scroll when menu is open
                if (navContainer.classList.contains("active")) {
                    document.body.style.overflow = "hidden";
                } else {
                    document.body.style.overflow = "";
                }
            }

            function closeMobileMenu() {
                const hamburger = document.getElementById("hamburger");
                const navContainer = document.getElementById("nav-container");
                const navOverlay = document.getElementById("nav-overlay");

                hamburger.classList.remove("active");
                navContainer.classList.remove("active");
                navOverlay.classList.remove("active");
                document.body.style.overflow = "";
            }

            document.addEventListener("DOMContentLoaded", function () {
                initBeltSelector();
                initTabs();
                // Load saved quiz belt level
                const savedQuizBelt = localStorage.getItem("quizBeltLevel");
                if (savedQuizBelt !== null) {
                    document.getElementById("belt-slider").value = savedQuizBelt;
                }
                updateBeltDisplay(); // Initialize belt slider display
            });

            // Quiz functionality
            const beltLevels = [
                { id: "9th", name: "9th Ky", color: "Red Belt", cssClass: "belt-red" },
                { id: "8th", name: "8th Ky", color: "Yellow Belt", cssClass: "belt-yellow" },
                { id: "7th", name: "7th Ky", color: "Orange Belt", cssClass: "belt-orange" },
                { id: "6th", name: "6th Ky", color: "Green Belt", cssClass: "belt-green" },
                { id: "5th", name: "5th Ky", color: "Blue Belt", cssClass: "belt-blue" },
                { id: "4th", name: "4th Ky", color: "Purple Belt", cssClass: "belt-purple" },
                { id: "3rd", name: "3rd Ky", color: "Brown Belt", cssClass: "belt-brown" },
                { id: "2nd", name: "2nd Ky", color: "Brown/White", cssClass: "belt-brown-white" },
                { id: "1st", name: "1st Ky", color: "Brown/Black", cssClass: "belt-brown-black" },
                { id: "Shodan", name: "Shodan", color: "1st Dan", cssClass: "belt-black-1dan" },
                { id: "Nidan", name: "Nidan", color: "2nd Dan", cssClass: "belt-black-2dan" },
                { id: "Sandan", name: "Sandan", color: "3rd Dan", cssClass: "belt-black-3dan" },
            ];

            const quizTerms = [
                // 9th Kyu (Red Belt) - Absolute basics
                {
                    term: "Jodan-uke",
                    answer: "Head block",
                    category: "Block",
                    belt: "9th",
                    wrong: ["Middle block", "Lower block", "Inside block"],
                },
                {
                    term: "Chudan-soto-uke",
                    answer: "Body outer block",
                    category: "Block",
                    belt: "9th",
                    wrong: ["Body inner block", "Head block", "Lower block"],
                },
                {
                    term: "Chudan-uchi-uke",
                    answer: "Body inner block",
                    category: "Block",
                    belt: "9th",
                    wrong: ["Body outer block", "Head block", "Lower block"],
                },
                {
                    term: "Gedan-barai",
                    answer: "Lower sweeping block",
                    category: "Block",
                    belt: "9th",
                    wrong: ["Head block", "Body block", "Upper block"],
                },
                {
                    term: "Jodan",
                    answer: "Upper level",
                    category: "Level",
                    belt: "9th",
                    wrong: ["Middle level", "Lower level", "Side level"],
                },
                {
                    term: "Chudan",
                    answer: "Middle level",
                    category: "Level",
                    belt: "9th",
                    wrong: ["Upper level", "Lower level", "Head height"],
                },
                {
                    term: "Gedan",
                    answer: "Lower level",
                    category: "Level",
                    belt: "9th",
                    wrong: ["Upper level", "Middle level", "Head height"],
                },
                {
                    term: "Maegeri",
                    answer: "Front kick",
                    category: "Technique",
                    belt: "9th",
                    wrong: ["Back kick", "Roundhouse kick", "Side kick"],
                },
                {
                    term: "Mawashigeri",
                    answer: "Roundhouse kick",
                    category: "Technique",
                    belt: "9th",
                    wrong: ["Front kick", "Side kick", "Back kick"],
                },
                {
                    term: "Uraken-uchi",
                    answer: "Back fist strike",
                    category: "Technique",
                    belt: "9th",
                    wrong: ["Elbow strike", "Reverse punch", "Front punch"],
                },
                {
                    term: "Yi",
                    answer: "Ready",
                    category: "Command",
                    belt: "9th",
                    wrong: ["Begin", "Stop", "Turn"],
                },
                {
                    term: "Rei",
                    answer: "Bow",
                    category: "Command",
                    belt: "9th",
                    wrong: ["Ready", "Begin", "Stop"],
                },
                {
                    term: "Hajime",
                    answer: "Begin",
                    category: "Command",
                    belt: "9th",
                    wrong: ["Stop", "Ready", "Turn"],
                },
                {
                    term: "Yame",
                    answer: "Stop",
                    category: "Command",
                    belt: "9th",
                    wrong: ["Begin", "Ready", "Bow"],
                },
                {
                    term: "Junzuki-dachi",
                    answer: "Front punch stance",
                    category: "Stance",
                    belt: "9th",
                    wrong: ["Fighting stance", "Reverse punch stance", "Horse stance"],
                },
                {
                    term: "Hanmi-gamae",
                    answer: "Half-body fighting stance",
                    category: "Stance",
                    belt: "9th",
                    wrong: ["Front punch stance", "Horse stance", "Cat stance"],
                },
                {
                    term: "Kata",
                    answer: "Form",
                    category: "General",
                    belt: "9th",
                    wrong: ["Sparring", "Technique", "Stance"],
                },
                {
                    term: "Kihon",
                    answer: "Basics",
                    category: "General",
                    belt: "9th",
                    wrong: ["Sparring", "Form", "Advanced"],
                },
                {
                    term: "Uke",
                    answer: "Block",
                    category: "General",
                    belt: "9th",
                    wrong: ["Kick", "Punch", "Strike"],
                },
                {
                    term: "Ichi",
                    answer: "One",
                    category: "Number",
                    belt: "9th",
                    wrong: ["Two", "Three", "Five"],
                },
                {
                    term: "Ni",
                    answer: "Two",
                    category: "Number",
                    belt: "9th",
                    wrong: ["One", "Three", "Four"],
                },
                {
                    term: "San",
                    answer: "Three",
                    category: "Number",
                    belt: "9th",
                    wrong: ["Two", "Four", "Five"],
                },
                {
                    term: "Go",
                    answer: "Five",
                    category: "Number",
                    belt: "9th",
                    wrong: ["One", "Three", "Four"],
                },

                // 8th Kyu (Yellow Belt) - Building on basics
                {
                    term: "Gyakuzuki",
                    answer: "Reverse punch",
                    category: "Technique",
                    belt: "8th",
                    wrong: ["Front kick", "Side kick", "Elbow strike"],
                },
                {
                    term: "Junzuki",
                    answer: "Straight punch",
                    category: "Technique",
                    belt: "8th",
                    wrong: ["Reverse punch", "Back fist", "Elbow strike"],
                },
                {
                    term: "Mawatte",
                    answer: "Turn around",
                    category: "Command",
                    belt: "8th",
                    wrong: ["Begin", "Stop", "Ready"],
                },
                {
                    term: "Sokuto",
                    answer: "Side edge kick",
                    category: "Technique",
                    belt: "8th",
                    wrong: ["Front kick", "Back kick", "Roundhouse kick"],
                },
                {
                    term: "Surikomi",
                    answer: "One step",
                    category: "Modifier",
                    belt: "8th",
                    wrong: ["Stepping", "Leaning", "Deflecting"],
                },

                // 7th Kyu (Orange Belt)
                {
                    term: "No-tsukkomi",
                    answer: "Leaning",
                    category: "Modifier",
                    belt: "7th",
                    wrong: ["Stepping", "One step", "Deflecting"],
                },
                {
                    term: "Gyakuzuki-dachi",
                    answer: "Reverse punch stance",
                    category: "Stance",
                    belt: "7th",
                    wrong: ["Front punch stance", "Fighting stance", "Horse stance"],
                },
                {
                    term: "Empi",
                    answer: "Elbow strike",
                    category: "Technique",
                    belt: "7th",
                    wrong: ["Back fist", "Reverse punch", "Front punch"],
                },
                {
                    term: "Ipponme",
                    answer: "First technique",
                    category: "Number",
                    belt: "7th",
                    wrong: ["Second technique", "Third technique", "Fifth technique"],
                },
                {
                    term: "Nihonme",
                    answer: "Second technique",
                    category: "Number",
                    belt: "7th",
                    wrong: ["First technique", "Third technique", "Fourth technique"],
                },
                {
                    term: "Sanbonme",
                    answer: "Third technique",
                    category: "Number",
                    belt: "7th",
                    wrong: ["Second technique", "Fourth technique", "Fifth technique"],
                },

                // 6th Kyu (Green Belt)
                {
                    term: "Kette",
                    answer: "Stepping",
                    category: "Modifier",
                    belt: "6th",
                    wrong: ["One step", "Leaning", "Deflecting"],
                },
                {
                    term: "Tobikomizuki",
                    answer: "Snap punch",
                    category: "Technique",
                    belt: "6th",
                    wrong: ["Reverse punch", "Straight punch", "Deflecting punch"],
                },
                {
                    term: "Yonhonme",
                    answer: "Fourth technique",
                    category: "Number",
                    belt: "6th",
                    wrong: ["Second technique", "Third technique", "Fifth technique"],
                },

                // 5th Kyu (Blue Belt)
                {
                    term: "Ushirogeri",
                    answer: "Back kick",
                    category: "Technique",
                    belt: "5th",
                    wrong: ["Front kick", "Side kick", "Roundhouse kick"],
                },
                {
                    term: "Nagashizuki",
                    answer: "Deflecting punch",
                    category: "Technique",
                    belt: "5th",
                    wrong: ["Snap punch", "Straight punch", "Reverse punch"],
                },
                {
                    term: "Gohonme",
                    answer: "Fifth technique",
                    category: "Number",
                    belt: "5th",
                    wrong: ["First technique", "Third technique", "Fourth technique"],
                },
                {
                    term: "Nidangeri",
                    answer: "Double level kick",
                    category: "Technique",
                    belt: "5th",
                    wrong: ["Front kick", "Side kick", "Roundhouse kick"],
                },

                // 4th Kyu (Purple Belt)
                {
                    term: "Ropponme",
                    answer: "Sixth technique",
                    category: "Number",
                    belt: "4th",
                    wrong: ["Fifth technique", "Seventh technique", "Eighth technique"],
                },

                // 3rd Kyu+ (Brown/Black) - Advanced sparring terms
                {
                    term: "Sanbon-Gumite",
                    answer: "Three-step sparring",
                    category: "Sparring",
                    belt: "3rd",
                    wrong: ["Free sparring", "One-step sparring", "Basic sparring"],
                },
                {
                    term: "Ohyo-Gumite",
                    answer: "Application sparring",
                    category: "Sparring",
                    belt: "3rd",
                    wrong: ["Three-step sparring", "Free sparring", "Basic sparring"],
                },
                {
                    term: "Kihon-Gumite",
                    answer: "Basic sparring",
                    category: "Sparring",
                    belt: "3rd",
                    wrong: ["Three-step sparring", "Free sparring", "Application sparring"],
                },
                {
                    term: "Jiyu-Gumite",
                    answer: "Free sparring",
                    category: "Sparring",
                    belt: "3rd",
                    wrong: ["Three-step sparring", "Basic sparring", "Application sparring"],
                },
            ];
            let currentQuiz = [];
            let currentQuestion = 0;
            let score = 0;
            let skipped = 0;
            let answered = false;
            let currentDifficulty = "beginner";
            let categoryStats = {};
            let quizHistory = [];
            let streakCount = 0;
            let currentStreak = 0;
            let missedQuestions = [];
            let timerInterval = null;
            let quizStartTime = 0;

            // Load saved data
            function loadUserData() {
                const saved = localStorage.getItem("hakubaProgress");
                if (saved) {
                    const data = JSON.parse(saved);
                    if (data.currentBelt) {
                        selectBelt(data.currentBelt);
                    }
                    if (data.quizHistory) {
                        quizHistory = data.quizHistory;
                    }
                    if (data.notes) {
                        window.userNotes = data.notes;
                    }
                    if (data.bookmarks) {
                        window.userBookmarks = data.bookmarks;
                    }
                    if (data.darkMode) {
                        toggleDarkMode(true);
                    }
                }
            }

            // Save user data
            function saveUserData() {
                const data = {
                    currentBelt: document.querySelector(".belt-button.active")?.dataset?.belt,
                    quizHistory: quizHistory.slice(-20), // Keep last 20
                    notes: window.userNotes || {},
                    bookmarks: window.userBookmarks || {},
                    darkMode: document.body.classList.contains("dark-mode"),
                };
                localStorage.setItem("hakubaProgress", JSON.stringify(data));
            }

            function updateBeltDisplay() {
                const sliderValue = parseInt(document.getElementById("belt-slider").value);
                localStorage.setItem("quizBeltLevel", sliderValue);
                const belt = beltLevels[sliderValue];

                // Update badge
                const badge = document.getElementById("belt-badge");
                badge.textContent = belt.name + " - " + belt.color;
                badge.className = belt.cssClass;

                // Get included belts
                const includedBelts = beltLevels.slice(0, sliderValue + 1);
                const beltNames = includedBelts.map((b) => b.color).join(", ");
                document.getElementById("included-belts").textContent = "Testing: " + beltNames;

                // Count available questions
                const beltIds = includedBelts.map((b) => b.id);
                const availableQuestions = quizTerms.filter((q) => beltIds.includes(q.belt));
                document.getElementById("question-count").textContent =
                    "~" + availableQuestions.length + " available questions";
            }

            function exitQuiz() {
                document.getElementById("quiz-active").style.display = "none";
                document.getElementById("quiz-complete").style.display = "none";
                document.getElementById("quiz-start").style.display = "block";
            }

            function updateProgressBar() {
                const progress = ((currentQuestion + 1) / currentQuiz.length) * 100;
                document.getElementById("quiz-progress-fill").style.width = progress + "%";
            }

            // Spaced repetition - track wrong answers
            function getQuizHistory() {
                const data = localStorage.getItem("quizHistory");
                return data ? JSON.parse(data) : {};
            }

            function saveQuizHistory(history) {
                localStorage.setItem("quizHistory", JSON.stringify(history));
            }

            function recordQuizAnswer(term, correct) {
                const history = getQuizHistory();
                if (!history[term]) {
                    history[term] = { wrong: 0, correct: 0, lastSeen: 0 };
                }
                if (correct) {
                    history[term].correct++;
                    // Reduce wrong count on correct answer (but not below 0)
                    history[term].wrong = Math.max(0, history[term].wrong - 1);
                } else {
                    history[term].wrong++;
                }
                history[term].lastSeen = Date.now();
                saveQuizHistory(history);
            }

            function startQuiz() {
                // Reset
                score = 0;
                skipped = 0;
                currentQuestion = 0;
                answered = false;
                categoryStats = {};

                // Get selected belt level
                const sliderValue = parseInt(document.getElementById("belt-slider").value);
                const selectedBelt = beltLevels[sliderValue];

                // Get all belts up to and including selected
                const includedBelts = beltLevels.slice(0, sliderValue + 1);
                const beltIds = includedBelts.map((b) => b.id);

                // Filter questions by included belts
                let availableTerms = quizTerms.filter((q) => beltIds.includes(q.belt));

                // Spaced repetition: prioritize terms that were answered wrong
                const history = getQuizHistory();
                availableTerms = availableTerms.map((term) => {
                    const record = history[term.term] || { wrong: 0, correct: 0, lastSeen: 0 };
                    // Calculate priority score: more wrong answers = higher priority
                    // Also boost terms not seen recently
                    const daysSinceLastSeen =
                        (Date.now() - record.lastSeen) / (1000 * 60 * 60 * 24);
                    const priority =
                        record.wrong * 3 +
                        (daysSinceLastSeen > 7 ? 2 : 0) +
                        (record.correct === 0 ? 1 : 0);
                    return { ...term, priority };
                });

                // Sort by priority (highest first), then shuffle within same priority
                availableTerms.sort((a, b) => {
                    if (b.priority !== a.priority) return b.priority - a.priority;
                    return Math.random() - 0.5;
                });

                // Select 10 questions (prioritized terms first)
                currentQuiz = availableTerms.slice(0, Math.min(10, availableTerms.length));

                // Initialize category stats
                currentQuiz.forEach((q) => {
                    if (!categoryStats[q.category]) {
                        categoryStats[q.category] = {
                            correct: 0,
                            incorrect: 0,
                            skipped: 0,
                            total: 0,
                        };
                    }
                    categoryStats[q.category].total++;
                });

                // Show quiz
                document.getElementById("quiz-start").style.display = "none";
                document.getElementById("quiz-complete").style.display = "none";
                document.getElementById("quiz-active").style.display = "block";

                // Display difficulty
                const beltNames = includedBelts.map((b) => b.color).join(", ");
                document.getElementById("quiz-difficulty-display").textContent =
                    "Testing: " + beltNames;

                // Display first question
                displayQuestion();
            }

            function displayQuestion() {
                const question = currentQuiz[currentQuestion];
                answered = false;

                // Update progress
                document.getElementById("quiz-score").textContent = score;
                document.getElementById("quiz-current").textContent = currentQuestion + 1;
                document.getElementById("quiz-total").textContent = currentQuiz.length;
                updateProgressBar();

                // Display question
                document.getElementById("quiz-category").textContent = question.category;
                document.getElementById("quiz-question").textContent = question.term;

                // Create options (shuffle correct answer with wrong answers)
                const options = [question.answer, ...question.wrong].sort(
                    () => Math.random() - 0.5,
                );

                const optionsContainer = document.getElementById("quiz-options");
                optionsContainer.innerHTML = "";

                options.forEach((option, index) => {
                    const button = document.createElement("button");
                    button.className = "quiz-option";
                    button.textContent = option;
                    button.setAttribute("data-key", index + 1);
                    button.onclick = () => checkAnswer(option, question.answer);
                    optionsContainer.appendChild(button);
                });

                // Hide feedback and next button, show skip button
                document.getElementById("quiz-feedback").style.display = "none";
                document.getElementById("quiz-next-btn").style.display = "none";
                document.getElementById("quiz-skip-btn").style.display = "inline-block";
            }

            function skipQuestion() {
                if (answered) return;
                answered = true;
                skipped++;

                const question = currentQuiz[currentQuestion];
                categoryStats[question.category].skipped++;

                // Disable all buttons
                const buttons = document.querySelectorAll(".quiz-option");
                buttons.forEach((btn) => {
                    btn.classList.add("disabled");
                    if (btn.textContent === question.answer) {
                        btn.classList.add("correct");
                    }
                });

                // Show feedback
                const feedback = document.getElementById("quiz-feedback");
                feedback.style.display = "block";
                feedback.className = "quiz-feedback";
                feedback.style.background = "#fef3c7";
                feedback.style.color = "#92400e";
                feedback.textContent = " Skipped. The correct answer was: " + question.answer;

                // Hide skip button, show next button
                document.getElementById("quiz-skip-btn").style.display = "none";
                document.getElementById("quiz-next-btn").style.display = "inline-block";
            }

            function checkAnswer(selected, correct) {
                if (answered) return;
                answered = true;

                const isCorrect = selected === correct;
                const question = currentQuiz[currentQuestion];

                // Record for spaced repetition
                recordQuizAnswer(question.term, isCorrect);

                if (isCorrect) {
                    score++;
                    categoryStats[question.category].correct++;
                } else {
                    categoryStats[question.category].incorrect++;
                }

                // Update all buttons
                const buttons = document.querySelectorAll(".quiz-option");
                buttons.forEach((btn) => {
                    btn.classList.add("disabled");
                    if (btn.textContent === correct) {
                        btn.classList.add("correct");
                    } else if (btn.textContent === selected && !isCorrect) {
                        btn.classList.add("incorrect");
                    }
                });

                // Show feedback
                const feedback = document.getElementById("quiz-feedback");
                feedback.style.display = "block";
                feedback.className = "quiz-feedback " + (isCorrect ? "correct" : "incorrect");
                feedback.textContent = isCorrect
                    ? " Correct!"
                    : " Incorrect. The correct answer is: " + correct;

                // Hide skip button
                document.getElementById("quiz-skip-btn").style.display = "none";

                // Auto-advance after correct answer, show next button for incorrect
                if (isCorrect) {
                    setTimeout(() => {
                        nextQuestion();
                    }, 800);
                } else {
                    document.getElementById("quiz-next-btn").style.display = "inline-block";
                }
            }

            function nextQuestion() {
                currentQuestion++;

                if (currentQuestion < currentQuiz.length) {
                    displayQuestion();
                } else {
                    showResults();
                }
            }

            function showResults() {
                document.getElementById("quiz-active").style.display = "none";
                document.getElementById("quiz-complete").style.display = "block";

                const attempted = currentQuiz.length - skipped;
                const percentage = attempted > 0 ? Math.round((score / attempted) * 100) : 0;
                const correct = score;
                const incorrect = attempted - score;

                document.getElementById("final-score").textContent = percentage;
                document.getElementById("correct-count").textContent = correct;
                document.getElementById("incorrect-count").textContent = incorrect;
                document.getElementById("skipped-count").textContent = skipped;
                document.getElementById("total-count").textContent = currentQuiz.length;

                // Show category breakdown
                let breakdownHTML =
                    '<h4 style="margin-bottom: 1rem; color: #111827; font-size: 1.125rem;">Performance by Category:</h4>';
                breakdownHTML += '<div style="display: grid; gap: 0.75rem;">';

                Object.keys(categoryStats)
                    .sort()
                    .forEach((category) => {
                        const stats = categoryStats[category];
                        const catPercentage =
                            stats.total > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;
                        const color =
                            catPercentage >= 80
                                ? "#059669"
                                : catPercentage >= 60
                                  ? "#f59e0b"
                                  : "#dc2626";

                        breakdownHTML +=
                            '<div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: white; border-radius: 0.5rem; border-left: 4px solid ' +
                            color +
                            ';">';
                        breakdownHTML +=
                            '<span style="font-weight: 600; color: #374151;">' +
                            category +
                            "</span>";
                        breakdownHTML +=
                            '<span style="color: #6b7280; font-size: 0.875rem;">' +
                            stats.correct +
                            "/" +
                            stats.total +
                            " (" +
                            catPercentage +
                            "%)</span>";
                        breakdownHTML += "</div>";
                    });

                breakdownHTML += "</div>";
                document.getElementById("category-breakdown").innerHTML = breakdownHTML;
            }

            // Keyboard shortcuts
            document.addEventListener("keydown", function (e) {
                const quizActive = document.getElementById("quiz-active").style.display === "block";
                if (!quizActive || answered) return;

                // Number keys 1-4 for selecting answers
                if (e.key >= "1" && e.key <= "4") {
                    const buttons = document.querySelectorAll(".quiz-option");
                    const index = parseInt(e.key) - 1;
                    if (buttons[index]) {
                        buttons[index].click();
                    }
                }

                // S key to skip
                if (e.key.toLowerCase() === "s" && !answered) {
                    skipQuestion();
                }

                // Escape to exit
                if (e.key === "Escape") {
                    exitQuiz();
                }
            });

            // Enter key for next question when answered
            document.addEventListener("keydown", function (e) {
                const quizActive = document.getElementById("quiz-active").style.display === "block";
                if (!quizActive || !answered) return;

                if (e.key === "Enter") {
                    nextQuestion();
                }
            });

            // ==========================================
            // PROGRESS TRACKING SYSTEM
            // ==========================================

            function setTrainingLevel(level, name) {
                userTrainingLevel = level;
                trainingLevelIndex = trainingBeltLevels[level].index;
            }

            function loadProgress() {
                const saved = localStorage.getItem("hakubaProgress");
                if (saved) {
                    learnedTechniques = JSON.parse(saved);
                }
            }

            function saveProgress() {
                localStorage.setItem("hakubaProgress", JSON.stringify(learnedTechniques));
            }

            function toggleLearned(techniqueId) {
                if (learnedTechniques[techniqueId]) {
                    delete learnedTechniques[techniqueId];
                } else {
                    learnedTechniques[techniqueId] = Date.now();
                }
                saveProgress();
                // Re-render current belt to update UI
                displayBelt(currentBelt);
                updateBeltProgress();
            }

            function isLearned(techniqueId) {
                return !!learnedTechniques[techniqueId];
            }

            function getBeltProgress(beltKey) {
                const belt = beltData[beltKey];
                if (!belt) return { learned: 0, total: 0, percentage: 0 };

                let total = 0;
                let learned = 0;

                // Count kihon techniques
                if (belt.kihon) {
                    if (belt.kihon.blocks) {
                        belt.kihon.blocks.forEach((t) => {
                            total++;
                            if (isLearned(beltKey + "-" + t.name)) learned++;
                        });
                    }
                    if (belt.kihon.strikes) {
                        belt.kihon.strikes.forEach((t) => {
                            total++;
                            if (isLearned(beltKey + "-" + t.name)) learned++;
                        });
                    }
                    if (belt.kihon.kicks) {
                        belt.kihon.kicks.forEach((t) => {
                            total++;
                            if (isLearned(beltKey + "-" + t.name)) learned++;
                        });
                    }
                    if (belt.kihon.list) {
                        belt.kihon.list.forEach((t) => {
                            total++;
                            if (isLearned(beltKey + "-" + t.name)) learned++;
                        });
                    }
                }

                // Count renraku techniques
                if (belt.renraku && belt.renraku.list) {
                    belt.renraku.list.forEach((t) => {
                        total++;
                        if (isLearned(beltKey + "-" + t.name)) learned++;
                    });
                }

                // Count uke techniques
                if (belt.uke && belt.uke.list) {
                    belt.uke.list.forEach((t) => {
                        total++;
                        if (isLearned(beltKey + "-" + t.name)) learned++;
                    });
                }

                const percentage = total > 0 ? Math.round((learned / total) * 100) : 0;
                return { learned, total, percentage };
            }

            function updateBeltProgress() {
                document.querySelectorAll(".belt-button").forEach((btn, index) => {
                    const beltKey = Object.keys(beltData)[index];
                    const progress = getBeltProgress(beltKey);

                    let progressBar = btn.querySelector(".belt-progress");
                    if (!progressBar && progress.total > 0) {
                        progressBar = document.createElement("div");
                        progressBar.className = "belt-progress";
                        progressBar.innerHTML = '<div class="belt-progress-fill"></div>';
                        btn.appendChild(progressBar);
                    }

                    if (progressBar) {
                        const fill = progressBar.querySelector(".belt-progress-fill");
                        fill.style.width = progress.percentage + "%";
                        if (progress.percentage === 100) {
                            fill.style.background = "#059669";
                        }
                    }
                });

                // Update overall progress bar
                updateOverallProgress();
            }

            function updateOverallProgress() {
                // Belt colors and data for rainbow bar
                const beltColors = {
                    "9th": { color: "#dc2626", name: "Red Belt" },
                    "8th": { color: "#fbbf24", name: "Yellow Belt" },
                    "7th": { color: "#f97316", name: "Orange Belt" },
                    "6th": { color: "#059669", name: "Green Belt" },
                    "5th": { color: "#2563eb", name: "Blue Belt" },
                    "4th": { color: "#7c3aed", name: "Purple Belt" },
                    "3rd": { color: "#92400e", name: "Brown Belt" },
                    "2nd": { color: "#78350f", name: "Brown/White" },
                    "1st": { color: "#451a03", name: "Brown/Black" },
                    Shodan: { color: "#1f2937", name: "1st Dan" },
                    Nidan: { color: "#111827", name: "2nd Dan" },
                    Sandan: { color: "#000000", name: "3rd Dan" },
                };

                const beltKeys = Object.keys(beltData);
                let beltStats = [];
                let totalLearned = 0;
                let totalTechniques = 0;

                // Calculate progress for each belt
                beltKeys.forEach((beltKey) => {
                    const progress = getBeltProgress(beltKey);
                    beltStats.push({
                        key: beltKey,
                        learned: progress.learned,
                        total: progress.total,
                        color: beltColors[beltKey]?.color || "#6b7280",
                        name: beltColors[beltKey]?.name || beltKey,
                    });
                    totalLearned += progress.learned;
                    totalTechniques += progress.total;
                });

                // Build rainbow progress bar
                const rainbowBar = document.getElementById("rainbow-progress-bar");
                if (rainbowBar && totalTechniques > 0) {
                    rainbowBar.innerHTML = "";

                    beltStats.forEach((belt, index) => {
                        if (belt.total > 0) {
                            const widthPercent = (belt.total / totalTechniques) * 100;
                            const segment = document.createElement("div");
                            segment.style.cssText =
                                "height: 100%; background: " +
                                belt.color +
                                "; width: " +
                                widthPercent +
                                "%;";

                            // Add subtle divider between segments (except last)
                            if (index < beltStats.length - 1) {
                                segment.style.borderRight = "1px solid rgba(255,255,255,0.3)";
                            }

                            // Dim incomplete sections to show progress
                            if (belt.learned === belt.total && belt.total > 0) {
                                segment.style.opacity = "1";
                            } else if (belt.learned > 0) {
                                segment.style.opacity = "0.85";
                            } else {
                                segment.style.opacity = "0.5";
                            }

                            rainbowBar.appendChild(segment);
                        }
                    });
                }

                // Position marker based on learned techniques
                const marker = document.getElementById("progress-marker");
                const percentage = totalTechniques > 0 ? (totalLearned / totalTechniques) * 100 : 0;
                if (marker) {
                    marker.style.left = percentage + "%";
                }

                // Find current belt (first one not fully completed)
                let currentBeltName = "Getting Started";
                for (let i = 0; i < beltStats.length; i++) {
                    const belt = beltStats[i];
                    if (belt.learned < belt.total) {
                        currentBeltName = "Working on: " + belt.name;
                        break;
                    } else if (i === beltStats.length - 1 && belt.learned === belt.total) {
                        currentBeltName = "Master - All Belts Complete!";
                    }
                }

                // Update UI
                const progressText = document.getElementById("overall-progress-text");
                const beltLabel = document.getElementById("current-belt-label");

                if (progressText) {
                    progressText.textContent =
                        totalLearned +
                        " / " +
                        totalTechniques +
                        " techniques (" +
                        Math.round(percentage) +
                        "%)";
                }

                if (beltLabel) {
                    beltLabel.textContent = currentBeltName;
                }
            }

            // Load progress on page load
            document.addEventListener("DOMContentLoaded", function () {
                loadProgress();
                setTimeout(updateBeltProgress, 100);
            });

            // ==========================================
            // STUDY MODES
            // ==========================================

            let flashcards = [];
            let currentFlashcardIndex = 0;
            let flashcardFlipped = false;

            function startFlashcards() {
                document.querySelector(".study-mode-selector").style.display = "none";
                document.getElementById("flashcard-container").style.display = "block";
                document.getElementById("focus-container").style.display = "none";

                // Populate belt selector
                const select = document.getElementById("flashcard-belt");
                select.innerHTML = '<option value="all">All Belts</option>';
                beltLevels.forEach((belt) => {
                    select.innerHTML +=
                        '<option value="' +
                        belt.id +
                        '">' +
                        belt.name +
                        " - " +
                        belt.color +
                        "</option>";
                });

                loadFlashcards();
            }

            function loadFlashcards() {
                const selectedBelt = document.getElementById("flashcard-belt").value;

                if (selectedBelt === "all") {
                    flashcards = [...quizTerms];
                } else {
                    // Get all belts up to and including selected
                    const beltIndex = beltLevels.findIndex((b) => b.id === selectedBelt);
                    const includedBelts = beltLevels.slice(0, beltIndex + 1).map((b) => b.id);
                    flashcards = quizTerms.filter((q) => includedBelts.includes(q.belt));
                }

                // Shuffle initially
                flashcards = flashcards.sort(() => Math.random() - 0.5);
                currentFlashcardIndex = 0;
                flashcardFlipped = false;
                displayFlashcard();
            }

            function displayFlashcard() {
                if (flashcards.length === 0) {
                    document.getElementById("flashcard-term").textContent = "No cards available";
                    document.getElementById("flashcard-category").textContent = "";
                    document.getElementById("flashcard-progress").textContent = "";
                    return;
                }

                const card = flashcards[currentFlashcardIndex];
                document.getElementById("flashcard-category").textContent = card.category;
                document.getElementById("flashcard-term").textContent = card.term;
                document.getElementById("flashcard-term-back").textContent = card.term;
                document.getElementById("flashcard-answer").textContent = card.answer;
                document.getElementById("flashcard-progress").textContent =
                    "Card " + (currentFlashcardIndex + 1) + " of " + flashcards.length;

                // Reset to front
                flashcardFlipped = false;
                document.getElementById("flashcard-front").style.display = "flex";
                document.getElementById("flashcard-back").style.display = "none";
                document.getElementById("flashcard").style.background = "white";
            }

            function flipFlashcard() {
                flashcardFlipped = !flashcardFlipped;
                if (flashcardFlipped) {
                    document.getElementById("flashcard-front").style.display = "none";
                    document.getElementById("flashcard-back").style.display = "flex";
                    document.getElementById("flashcard").style.background = "#f0fdf4";
                } else {
                    document.getElementById("flashcard-front").style.display = "flex";
                    document.getElementById("flashcard-back").style.display = "none";
                    document.getElementById("flashcard").style.background = "white";
                }
            }

            function nextFlashcard() {
                currentFlashcardIndex = (currentFlashcardIndex + 1) % flashcards.length;
                displayFlashcard();
            }

            function prevFlashcard() {
                currentFlashcardIndex =
                    (currentFlashcardIndex - 1 + flashcards.length) % flashcards.length;
                displayFlashcard();
            }

            function shuffleFlashcards() {
                flashcards = flashcards.sort(() => Math.random() - 0.5);
                currentFlashcardIndex = 0;
                displayFlashcard();
            }

            function startFocusMode() {
                document.querySelector(".study-mode-selector").style.display = "none";
                document.getElementById("flashcard-container").style.display = "none";
                document.getElementById("focus-container").style.display = "block";

                showFocusCategories();
            }

            function showFocusCategories() {
                document.getElementById("focus-category-select").style.display = "block";
                document.getElementById("focus-content").style.display = "none";

                // Get unique categories
                const categories = [...new Set(quizTerms.map((q) => q.category))].sort();

                const container = document.getElementById("focus-categories");
                container.innerHTML = "";

                categories.forEach((category) => {
                    const count = quizTerms.filter((q) => q.category === category).length;
                    const btn = document.createElement("button");
                    btn.style.cssText =
                        "padding: 1rem; background: white; border: 1px solid #e5e7eb; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s; text-align: center;";
                    btn.innerHTML =
                        '<div style="font-weight: 600; color: #1e5ba8;">' +
                        category +
                        '</div><div style="font-size: 0.875rem; color: #6b7280; margin-top: 0.25rem;">' +
                        count +
                        " terms</div>";
                    btn.onmouseover = function () {
                        this.style.borderColor = "#1e5ba8";
                    };
                    btn.onmouseout = function () {
                        this.style.borderColor = "#e5e7eb";
                    };
                    btn.onclick = function () {
                        showFocusCategory(category);
                    };
                    container.appendChild(btn);
                });
            }

            function showFocusCategory(category) {
                document.getElementById("focus-category-select").style.display = "none";
                document.getElementById("focus-content").style.display = "block";
                document.getElementById("focus-title").textContent = category + " Terms";

                const terms = quizTerms.filter((q) => q.category === category);
                const container = document.getElementById("focus-terms");
                container.innerHTML = "";

                terms.forEach((term) => {
                    const beltInfo = beltLevels.find((b) => b.id === term.belt);
                    const card = document.createElement("div");
                    card.style.cssText =
                        "background: white; border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1.25rem; cursor: pointer; transition: all 0.2s;";
                    card.innerHTML =
                        '<div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">' +
                        '<div style="font-size: 1.25rem; font-weight: 600; color: #1e5ba8;">' +
                        term.term +
                        "</div>" +
                        '<div style="font-size: 0.75rem; padding: 0.25rem 0.5rem; background: #f3f4f6; border-radius: 0.25rem; color: #6b7280;">' +
                        (beltInfo ? beltInfo.color : term.belt) +
                        "</div>" +
                        "</div>" +
                        '<div class="focus-answer" style="color: #059669; font-weight: 500; display: none;">' +
                        term.answer +
                        "</div>" +
                        '<div class="focus-reveal" style="color: #9ca3af; font-size: 0.875rem;">Click to reveal</div>';

                    card.onclick = function () {
                        const answer = this.querySelector(".focus-answer");
                        const reveal = this.querySelector(".focus-reveal");
                        if (answer.style.display === "none") {
                            answer.style.display = "block";
                            reveal.style.display = "none";
                            this.style.background = "#f0fdf4";
                        } else {
                            answer.style.display = "none";
                            reveal.style.display = "block";
                            this.style.background = "white";
                        }
                    };

                    container.appendChild(card);
                });
            }

            function exitStudyMode() {
                document.querySelector(".study-mode-selector").style.display = "grid";
                document.getElementById("flashcard-container").style.display = "none";
                document.getElementById("focus-container").style.display = "none";
            }

            // Keyboard shortcuts for flashcards
            document.addEventListener("keydown", function (e) {
                const flashcardActive =
                    document.getElementById("flashcard-container").style.display === "block";
                if (!flashcardActive) return;

                if (e.code === "Space") {
                    e.preventDefault();
                    flipFlashcard();
                } else if (e.key === "ArrowRight") {
                    nextFlashcard();
                } else if (e.key === "ArrowLeft") {
                    prevFlashcard();
                } else if (e.key.toLowerCase() === "s") {
                    shuffleFlashcards();
                } else if (e.key === "Escape") {
                    exitStudyMode();
                }
            });

            // ==========================================
            // GRADING CHECKLIST
            // ==========================================

            let gradingChecklist = {};

            function loadGradingChecklist() {
                const saved = localStorage.getItem("hakubaGradingChecklist");
                if (saved) {
                    gradingChecklist = JSON.parse(saved);
                }
            }

            function saveGradingChecklist() {
                localStorage.setItem("hakubaGradingChecklist", JSON.stringify(gradingChecklist));
            }

            function initGradingChecklist() {
                loadGradingChecklist();

                // Populate belt selector
                const select = document.getElementById("grading-current-belt");
                if (!select) return;
                select.innerHTML = "";

                // Add "No Belt / White Belt" option for beginners
                select.innerHTML += '<option value="none">No Belt / White Belt</option>';

                const beltKeys = Object.keys(beltData);
                beltKeys.forEach((key, index) => {
                    if (index < beltKeys.length - 1) {
                        const belt = beltData[key];
                        select.innerHTML +=
                            '<option value="' +
                            key +
                            '">' +
                            belt.name +
                            " - " +
                            belt.color +
                            "</option>";
                    }
                });

                updateGradingChecklist();
            }

            function getNextBelt(currentKey) {
                // Handle "none" (white belt) case - next belt is 9th Kyu (Red)
                if (currentKey === "none") {
                    return "9th";
                }
                const keys = Object.keys(beltData);
                const currentIndex = keys.indexOf(currentKey);
                if (currentIndex < keys.length - 1) {
                    return keys[currentIndex + 1];
                }
                return null;
            }

            function toggleGradingItem(itemId) {
                if (gradingChecklist[itemId]) {
                    delete gradingChecklist[itemId];
                } else {
                    gradingChecklist[itemId] = Date.now();
                }
                saveGradingChecklist();
                updateGradingChecklist();
            }

            // Search functionality
            function performSearch() {
                const query = document.getElementById("search-input").value.toLowerCase().trim();
                const resultsDiv = document.getElementById("search-results");
                const countDiv = document.getElementById("search-results-count");

                if (query.length < 2) {
                    resultsDiv.innerHTML =
                        '<p style="color: #6b7280;">Enter at least 2 characters to search.</p>';
                    countDiv.textContent = "";
                    return;
                }

                let results = [];

                // Search quizTerms (terminology)
                quizTerms.forEach((item) => {
                    if (
                        item.term.toLowerCase().includes(query) ||
                        item.answer.toLowerCase().includes(query) ||
                        item.category.toLowerCase().includes(query)
                    ) {
                        results.push({
                            type: "Terminology",
                            japanese: item.term,
                            english: item.answer,
                            category: item.category,
                            belt: item.belt,
                        });
                    }
                });

                // Search beltData (techniques from syllabus)
                Object.keys(beltData).forEach((beltKey) => {
                    const belt = beltData[beltKey];

                    // Search kihon
                    if (belt.kihon && belt.kihon.list) {
                        belt.kihon.list.forEach((tech) => {
                            if (
                                tech.name.toLowerCase().includes(query) ||
                                tech.translation.toLowerCase().includes(query)
                            ) {
                                results.push({
                                    type: "Kihon",
                                    japanese: tech.name,
                                    english: tech.translation,
                                    category: "Basic Technique",
                                    belt: beltKey,
                                });
                            }
                        });
                    }

                    // Search renraku
                    if (belt.renraku && belt.renraku.list) {
                        belt.renraku.list.forEach((tech) => {
                            if (
                                tech.name.toLowerCase().includes(query) ||
                                tech.translation.toLowerCase().includes(query)
                            ) {
                                results.push({
                                    type: "Renraku",
                                    japanese: tech.name,
                                    english: tech.translation,
                                    category: "Combination",
                                    belt: beltKey,
                                });
                            }
                        });
                    }

                    // Search kata
                    if (belt.kata && belt.kata.name.toLowerCase().includes(query)) {
                        results.push({
                            type: "Kata",
                            japanese: belt.kata.name,
                            english: "Form/Pattern",
                            category: "Kata",
                            belt: beltKey,
                        });
                    }
                });

                // Remove duplicates based on japanese name
                const seen = new Set();
                results = results.filter((item) => {
                    const key = item.japanese.toLowerCase();
                    if (seen.has(key)) return false;
                    seen.add(key);
                    return true;
                });

                // Sort by relevance (exact match first, then by belt level)
                results.sort((a, b) => {
                    const aExact =
                        a.japanese.toLowerCase() === query || a.english.toLowerCase() === query;
                    const bExact =
                        b.japanese.toLowerCase() === query || b.english.toLowerCase() === query;
                    if (aExact && !bExact) return -1;
                    if (bExact && !aExact) return 1;
                    return 0;
                });

                // Display results
                countDiv.textContent =
                    results.length + " result" + (results.length !== 1 ? "s" : "") + " found";

                if (results.length === 0) {
                    resultsDiv.innerHTML =
                        '<p style="color: #6b7280;">No results found for "' + query + '"</p>';
                    return;
                }

                const beltColors = {
                    "9th": { bg: "#fef2f2", border: "#dc2626", name: "Red Belt" },
                    "8th": { bg: "#fefce8", border: "#fbbf24", name: "Yellow Belt" },
                    "7th": { bg: "#fff7ed", border: "#f97316", name: "Orange Belt" },
                    "6th": { bg: "#f0fdf4", border: "#059669", name: "Green Belt" },
                    "5th": { bg: "#eff6ff", border: "#2563eb", name: "Blue Belt" },
                    "4th": { bg: "#faf5ff", border: "#7c3aed", name: "Purple Belt" },
                    "3rd": { bg: "#fef3c7", border: "#92400e", name: "Brown Belt" },
                    "2nd": { bg: "#fef3c7", border: "#78350f", name: "Brown/White" },
                    "1st": { bg: "#fef3c7", border: "#451a03", name: "Brown/Black" },
                    Shodan: { bg: "#f3f4f6", border: "#1f2937", name: "1st Dan" },
                    Nidan: { bg: "#f3f4f6", border: "#111827", name: "2nd Dan" },
                    Sandan: { bg: "#f3f4f6", border: "#000000", name: "3rd Dan" },
                };

                let html = '<div class="technique-grid">';
                results.forEach((item) => {
                    const beltInfo = beltColors[item.belt] || {
                        bg: "#f9fafb",
                        border: "#6b7280",
                        name: item.belt,
                    };
                    html +=
                        '<div class="technique-card" style="border-left: 4px solid ' +
                        beltInfo.border +
                        ';">';
                    html += '<div class="japanese">' + item.japanese + "</div>";
                    html += '<div class="english">' + item.english + "</div>";
                    html +=
                        '<div style="margin-top: 0.75rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">';
                    html +=
                        '<span style="font-size: 0.75rem; padding: 0.25rem 0.5rem; background: ' +
                        beltInfo.bg +
                        '; border-radius: 0.25rem; color: #374151;">' +
                        beltInfo.name +
                        "</span>";
                    html +=
                        '<span style="font-size: 0.75rem; padding: 0.25rem 0.5rem; background: #f3f4f6; border-radius: 0.25rem; color: #374151;">' +
                        item.type +
                        "</span>";
                    html += "</div>";
                    html += "</div>";
                });
                html += "</div>";

                resultsDiv.innerHTML = html;
            }

            function updateGradingChecklist() {
                const select = document.getElementById("grading-current-belt");
                if (!select) return;

                const currentBeltKey = select.value;
                const nextBeltKey = getNextBelt(currentBeltKey);

                if (!nextBeltKey) {
                    document.getElementById("grading-target-belt").textContent =
                        "Congratulations! You've reached the highest level.";
                    document.getElementById("grading-checklist-content").innerHTML = "";
                    return;
                }

                const nextBelt = beltData[nextBeltKey];
                document.getElementById("grading-target-belt").textContent =
                    nextBelt.name + " - " + nextBelt.color;

                let totalItems = 0;
                let checkedItems = 0;
                let html = "";

                // Build checklist sections
                const sections = [];

                // General requirements
                const generalItems = [];
                if (nextBelt.dojoKun) {
                    generalItems.push({
                        id: "dojo-kun",
                        text: "Dojo Kun - Recite in Japanese and English",
                    });
                }
                if (nextBelt.beltTying) {
                    generalItems.push({
                        id: "belt-tying",
                        text: "Hon-Musubi - Traditional belt tying technique",
                    });
                }
                if (generalItems.length > 0) {
                    sections.push({ title: "General Requirements", items: generalItems });
                }

                // Kihon techniques
                if (nextBelt.kihon) {
                    const kihonItems = [];
                    if (nextBelt.kihon.blocks) {
                        nextBelt.kihon.blocks.forEach((t) => {
                            kihonItems.push({
                                id: "kihon-" + t.name,
                                text: t.name + " - " + t.translation,
                            });
                        });
                    }
                    if (nextBelt.kihon.strikes) {
                        nextBelt.kihon.strikes.forEach((t) => {
                            kihonItems.push({
                                id: "kihon-" + t.name,
                                text: t.name + " - " + t.translation,
                            });
                        });
                    }
                    if (nextBelt.kihon.kicks) {
                        nextBelt.kihon.kicks.forEach((t) => {
                            kihonItems.push({
                                id: "kihon-" + t.name,
                                text: t.name + " - " + t.translation,
                            });
                        });
                    }
                    if (nextBelt.kihon.list) {
                        nextBelt.kihon.list.forEach((t) => {
                            kihonItems.push({
                                id: "kihon-" + t.name,
                                text: t.name + " - " + t.translation,
                            });
                        });
                    }
                    if (kihonItems.length > 0) {
                        sections.push({
                            title: "Kihon-Waza (Fundamental Techniques)",
                            items: kihonItems,
                        });
                    }
                }

                // Renraku techniques
                if (nextBelt.renraku && nextBelt.renraku.list) {
                    const renrakuItems = nextBelt.renraku.list.map((t) => ({
                        id: "renraku-" + t.name,
                        text: t.name + " - " + t.translation,
                    }));
                    sections.push({ title: nextBelt.renraku.title, items: renrakuItems });
                }

                // Uke techniques
                if (nextBelt.uke && nextBelt.uke.list) {
                    const ukeItems = nextBelt.uke.list.map((t) => ({
                        id: "uke-" + t.name,
                        text: t.name + " - " + t.translation,
                    }));
                    sections.push({ title: nextBelt.uke.title, items: ukeItems });
                }

                // Sanbon-Gumite
                if (nextBelt.sanbon && nextBelt.sanbon.items) {
                    const sanbonItems = nextBelt.sanbon.items.map((t) => ({
                        id: "sanbon-" + t.name,
                        text: t.name + " - " + t.translation,
                    }));
                    sections.push({ title: nextBelt.sanbon.title, items: sanbonItems });
                }

                // Ohyo-Gumite
                if (nextBelt.ohyo && nextBelt.ohyo.items) {
                    const ohyoItems = nextBelt.ohyo.items.map((t) => ({
                        id: "ohyo-" + t.name,
                        text: t.name + " - " + t.translation,
                    }));
                    sections.push({ title: nextBelt.ohyo.title, items: ohyoItems });
                }

                // Kihon-Gumite
                if (nextBelt.kihonGumite && nextBelt.kihonGumite.items) {
                    const kihonGumiteItems = nextBelt.kihonGumite.items.map((t) => ({
                        id: "kihongumite-" + t.name,
                        text: t.name + " - " + t.translation,
                    }));
                    sections.push({ title: nextBelt.kihonGumite.title, items: kihonGumiteItems });
                }

                // Machi-Ohyo
                if (nextBelt.machiOhyo && nextBelt.machiOhyo.items) {
                    const machiItems = nextBelt.machiOhyo.items.map((t) => ({
                        id: "machi-" + t.name,
                        text: t.name + " - " + t.translation,
                    }));
                    sections.push({ title: nextBelt.machiOhyo.title, items: machiItems });
                }

                // Kata
                if (nextBelt.kata) {
                    sections.push({
                        title: "Kata",
                        items: [{ id: "kata-" + nextBelt.kata.name, text: nextBelt.kata.name }],
                    });
                }

                // Additional requirements
                if (nextBelt.additional) {
                    const additionalItems = [];
                    if (nextBelt.additional.jiyuGumite) {
                        additionalItems.push({
                            id: "jiyu-gumite",
                            text: "Jiyu-Gumite - " + nextBelt.additional.jiyuGumite,
                        });
                    }
                    if (nextBelt.additional.hikkiShiken) {
                        additionalItems.push({
                            id: "hikki-shiken",
                            text: "Hikki-Shiken - " + nextBelt.additional.hikkiShiken,
                        });
                    }
                    if (additionalItems.length > 0) {
                        sections.push({ title: "Additional Requirements", items: additionalItems });
                    }
                }

                // Render sections
                sections.forEach((section) => {
                    html += '<div style="margin-bottom: 2rem;">';
                    html +=
                        '<h3 style="font-size: 1.25rem; color: #1e5ba8; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #e5e7eb;">' +
                        section.title +
                        "</h3>";
                    html += '<div style="display: grid; gap: 0.5rem;">';

                    section.items.forEach((item) => {
                        const itemKey = nextBeltKey + "-" + item.id;
                        const isChecked = !!gradingChecklist[itemKey];
                        totalItems++;
                        if (isChecked) checkedItems++;

                        const checkboxStyle = isChecked
                            ? "width: 24px; height: 24px; border: 2px solid #059669; background: #059669; border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0;"
                            : "width: 24px; height: 24px; border: 2px solid #d1d5db; background: white; border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0;";

                        const textStyle = isChecked
                            ? "color: #6b7280; text-decoration: line-through;"
                            : "color: #374151;";

                        html +=
                            '<div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: white; border: 1px solid #e5e7eb; border-radius: 0.375rem; cursor: pointer;" onclick="toggleGradingItem(\'' +
                            itemKey.replace(/'/g, "\\'") +
                            "')\">";
                        html += '<div style="' + checkboxStyle + '">';
                        if (isChecked) {
                            html +=
                                '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg>';
                        }
                        html += "</div>";
                        html += '<span style="' + textStyle + '">' + item.text + "</span>";
                        html += "</div>";
                    });

                    html += "</div></div>";
                });

                document.getElementById("grading-checklist-content").innerHTML = html;

                // Update progress
                const percentage =
                    totalItems > 0 ? Math.round((checkedItems / totalItems) * 100) : 0;
                document.getElementById("grading-progress-text").textContent =
                    checkedItems + " / " + totalItems + " (" + percentage + "%)";
                document.getElementById("grading-progress-bar").style.width = percentage + "%";

                if (percentage === 100) {
                    document.getElementById("grading-progress-bar").style.background = "#059669";
                } else {
                    document.getElementById("grading-progress-bar").style.background = "#1e5ba8";
                }
            }

            // Initialize grading checklist when DOM is ready
            document.addEventListener("DOMContentLoaded", function () {
                initGradingChecklist();
            });

            // ==========================================
            // PWA - SERVICE WORKER & OFFLINE SUPPORT
            // ==========================================

            // Register service worker for offline support
            if ("serviceWorker" in navigator) {
                // Create service worker code as a blob
                const swCode = `
                    const CACHE_NAME = 'hakuba-karate-v1';
                    const ASSETS_TO_CACHE = [
                        './',
                        './hakuba-wado-complete-v2.html'
                    ];

                    // Install event - cache assets
                    self.addEventListener('install', (event) => {
                        event.waitUntil(
                            caches.open(CACHE_NAME).then((cache) => {
                                return cache.addAll(ASSETS_TO_CACHE);
                            })
                        );
                        self.skipWaiting();
                    });

                    // Activate event - clean old caches
                    self.addEventListener('activate', (event) => {
                        event.waitUntil(
                            caches.keys().then((cacheNames) => {
                                return Promise.all(
                                    cacheNames.map((cacheName) => {
                                        if (cacheName !== CACHE_NAME) {
                                            return caches.delete(cacheName);
                                        }
                                    })
                                );
                            })
                        );
                        self.clients.claim();
                    });

                    // Fetch event - serve from cache, fallback to network
                    self.addEventListener('fetch', (event) => {
                        // Skip non-GET requests
                        if (event.request.method !== 'GET') return;

                        // Skip external requests (like YouTube, fonts)
                        if (!event.request.url.startsWith(self.location.origin)) {
                            return;
                        }

                        event.respondWith(
                            caches.match(event.request).then((cachedResponse) => {
                                if (cachedResponse) {
                                    // Return cached version and update cache in background
                                    event.waitUntil(
                                        fetch(event.request).then((response) => {
                                            if (response.ok) {
                                                caches.open(CACHE_NAME).then((cache) => {
                                                    cache.put(event.request, response);
                                                });
                                            }
                                        }).catch(() => {})
                                    );
                                    return cachedResponse;
                                }

                                // Not in cache - fetch from network
                                return fetch(event.request).then((response) => {
                                    // Cache successful responses
                                    if (response.ok) {
                                        const responseClone = response.clone();
                                        caches.open(CACHE_NAME).then((cache) => {
                                            cache.put(event.request, responseClone);
                                        });
                                    }
                                    return response;
                                }).catch(() => {
                                    // Offline and not in cache
                                    return new Response('Offline - content not available', {
                                        status: 503,
                                        statusText: 'Service Unavailable'
                                    });
                                });
                            })
                        );
                    });
                `;

                const swBlob = new Blob([swCode], { type: "application/javascript" });
                const swUrl = URL.createObjectURL(swBlob);

                navigator.serviceWorker
                    .register(swUrl, { scope: "./" })
                    .then((registration) => {
                        console.log("Service Worker registered successfully");

                        // Check for updates periodically
                        setInterval(
                            () => {
                                registration.update();
                            },
                            60 * 60 * 1000,
                        ); // Check every hour
                    })
                    .catch((error) => {
                        console.log("Service Worker registration failed:", error);
                    });
            }

            // Show install prompt for PWA
            let deferredPrompt = null;

            window.addEventListener("beforeinstallprompt", (e) => {
                e.preventDefault();
                deferredPrompt = e;

                // Show install button in header
                showInstallButton();
            });

            function showInstallButton() {
                // Check if already installed
                if (window.matchMedia("(display-mode: standalone)").matches) {
                    return;
                }

                const header = document.querySelector("header .container");
                if (header && !document.getElementById("install-btn")) {
                    const installBtn = document.createElement("button");
                    installBtn.id = "install-btn";
                    installBtn.innerHTML = "Install App";
                    installBtn.style.cssText =
                        "position: absolute; right: 2rem; top: 50%; transform: translateY(-50%); background: white; color: #1e5ba8; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; cursor: pointer; font-size: 0.875rem;";
                    installBtn.onclick = installApp;
                    header.style.position = "relative";
                    header.appendChild(installBtn);
                }
            }

            function installApp() {
                if (!deferredPrompt) return;

                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === "accepted") {
                        console.log("User accepted the install prompt");
                        const installBtn = document.getElementById("install-btn");
                        if (installBtn) installBtn.remove();
                    }
                    deferredPrompt = null;
                });
            }

            // Handle app installed event
            window.addEventListener("appinstalled", () => {
                console.log("App installed successfully");
                const installBtn = document.getElementById("install-btn");
                if (installBtn) installBtn.remove();
                deferredPrompt = null;
            });

            // Detect if running as installed PWA
            if (window.matchMedia("(display-mode: standalone)").matches) {
                console.log("Running as installed PWA");
            }
        </script>
    </body>
</html>
